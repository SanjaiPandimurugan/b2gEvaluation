<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/water.css@2/out/water.css"><link rel="stylesheet" href="../custom.css"><div class="middle-column">
 <section id="overview">
  <h1 class="hckui__typography__h1" itemprop="name">
   Portable Medical Commode for Mobility Impaired Patients
  </h1>
  <p class="hckui__typography__bodyL hckui__layout__marginBottom15" itemprop="description">
   A demonstration of touch control-based user interface for portable medical commode with all the quirks of a fully-fledged toilet
  </p>
  <div class="hckui__layout__marginTop30">
   <div class="hckui__layout__hiddenMedUp">
   </div>
   <div class="project-cover-image" itemprop="image" itemscope="" itemtype="https://schema.org/ImageObject">
    <meta content="https://hackster.imgix.net/uploads/attachments/1563656/_5pEPv6j5WF.blob?auto=compress&amp;w=900&amp;h=675&amp;fit=min&amp;fm=jpg" itemprop="url"/>
    <meta content="900" itemprop="width"/>
    <meta content="675" itemprop="height"/>
    <img alt="Portable Medical Commode for Mobility Impaired Patients" src="34.jpg"/>
   </div>
  </div>
 </section>
 <div class="project-section-break">
 </div>
 <div id="project_page_simple_ad_portal">
 </div>
 <div id="description" itemprop="articleBody">
  <section id="things">
   <div class="project-section-title">
    <h2 class="hckui__typography__h2 title-with-anchor">
     <span>
      Things used in this project
     </span>
    </h2>
   </div>
   <div class="project-parts">
    <div class="view-expanded" style="display:block">
     <table class="project-parts-table">
      <colgroup>
       <col style="width: 100px; height: 50px;"/>
       <col style="width: auto;"/>
      </colgroup>
      <tbody>
       <tr class="head">
        <td colspan="2">
         <h3 class="hckui__typography__h3">
          Hardware components
         </h3>
        </td>
        <tr>
         <td class="part-img">
          <img alt="PSoC 4 Prototyping Kit" src="35.jpg" srcset="https://hackster.imgix.net/uploads/image/file/57306/M-08446.jpg?auto=compress%2Cformat&amp;w=96&amp;h=96&amp;fit=fill&amp;bg=ffffff 2x, https://hackster.imgix.net/uploads/image/file/57306/M-08446.jpg?auto=compress%2Cformat&amp;w=48&amp;h=48&amp;fit=fill&amp;bg=ffffff"/>
         </td>
         <td class="hckui__typography__bodyL">
          <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"Cypress PSoC 4 Prototyping Kit","href":"/cypress/products/psoc-4-prototyping-kit?ref=project-784142","type":"part","location":"things"},"clickOpts":{"delayRedirect":true}}' href="https://www.hackster.io/cypress/products/psoc-4-prototyping-kit?ref=project-784142">
           Cypress PSoC 4 Prototyping Kit
          </a>
         </td>
        </tr>
        <tr>
         <td class="part-img">
          <img alt="SG90 Micro-servo motor" src="36.jpg" srcset="https://hackster.imgix.net/uploads/attachments/657402/SG90-Servo-Motor-180-Degrees-SG90-Micro.jpg?auto=compress%2Cformat&amp;w=96&amp;h=96&amp;fit=fill&amp;bg=ffffff 2x, https://hackster.imgix.net/uploads/attachments/657402/SG90-Servo-Motor-180-Degrees-SG90-Micro.jpg?auto=compress%2Cformat&amp;w=48&amp;h=48&amp;fit=fill&amp;bg=ffffff"/>
         </td>
         <td class="hckui__typography__bodyL">
          SG90 Micro-servo motor
         </td>
        </tr>
        <tr>
         <td class="part-img">
          <img alt="Fermion: Voice Recorder Module (Breakout)" src="37.jpg" srcset="https://hackster.imgix.net/uploads/attachments/1285589/DFR0745.jpg?auto=compress%2Cformat&amp;w=96&amp;h=96&amp;fit=fill&amp;bg=ffffff 2x, https://hackster.imgix.net/uploads/attachments/1285589/DFR0745.jpg?auto=compress%2Cformat&amp;w=48&amp;h=48&amp;fit=fill&amp;bg=ffffff"/>
         </td>
         <td class="hckui__typography__bodyL">
          <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"DFRobot Fermion: Voice Recorder Module (Breakout)","href":"/dfrobot/products/fermion-voice-recorder-module-breakout?ref=project-784142","type":"part","location":"things"},"clickOpts":{"delayRedirect":true}}' href="https://www.hackster.io/dfrobot/products/fermion-voice-recorder-module-breakout?ref=project-784142">
           DFRobot Fermion: Voice Recorder Module (Breakout)
          </a>
         </td>
        </tr>
        <tr>
         <td class="part-img">
          <img alt="Grove - OLED Display 1.12'' V2" src="38.jpg" srcset="https://hackster.imgix.net/uploads/attachments/471220/bazaar696800_img_5488a.JPG?auto=compress%2Cformat&amp;w=96&amp;h=96&amp;fit=fill&amp;bg=ffffff 2x, https://hackster.imgix.net/uploads/attachments/471220/bazaar696800_img_5488a.JPG?auto=compress%2Cformat&amp;w=48&amp;h=48&amp;fit=fill&amp;bg=ffffff"/>
         </td>
         <td class="hckui__typography__bodyL">
          <a class="hckui__typography__linkBlue" data-ha="{&quot;eventName&quot;:&quot;Clicked link&quot;,&quot;customProps&quot;:{&quot;value&quot;:&quot;Seeed Studio Grove - OLED Display 1.12'' V2&quot;,&quot;href&quot;:&quot;/seeed/products/grove-oled-display-1-12-v2?ref=project-784142&quot;,&quot;type&quot;:&quot;part&quot;,&quot;location&quot;:&quot;things&quot;},&quot;clickOpts&quot;:{&quot;delayRedirect&quot;:true}}" href="https://www.hackster.io/seeed/products/grove-oled-display-1-12-v2?ref=project-784142">
           Seeed Studio Grove - OLED Display 1.12'' V2
          </a>
         </td>
        </tr>
        <tr>
         <td class="part-img">
          <img alt="Stereo Enclosed Speaker - 3W 8Ω" src="39.jpg" srcset="https://hackster.imgix.net/uploads/attachments/1514245/1.jpg?auto=compress%2Cformat&amp;w=96&amp;h=96&amp;fit=fill&amp;bg=ffffff 2x, https://hackster.imgix.net/uploads/attachments/1514245/1.jpg?auto=compress%2Cformat&amp;w=48&amp;h=48&amp;fit=fill&amp;bg=ffffff"/>
         </td>
         <td class="hckui__typography__bodyL">
          <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"DFRobot Stereo Enclosed Speaker - 3W 8Ω","href":"/dfrobot/products/stereo-enclosed-speaker-3w-8?ref=project-784142","type":"part","location":"things"},"clickOpts":{"delayRedirect":true}}' href="https://www.hackster.io/dfrobot/products/stereo-enclosed-speaker-3w-8?ref=project-784142">
           DFRobot Stereo Enclosed Speaker - 3W 8Ω
          </a>
         </td>
        </tr>
        <tr>
         <td class="part-img">
          <img alt="Grove - Vibration Motor" src="40.jpg" srcset="https://hackster.imgix.net/uploads/attachments/544350/gvib.jpg?auto=compress%2Cformat&amp;w=96&amp;h=96&amp;fit=fill&amp;bg=ffffff 2x, https://hackster.imgix.net/uploads/attachments/544350/gvib.jpg?auto=compress%2Cformat&amp;w=48&amp;h=48&amp;fit=fill&amp;bg=ffffff"/>
         </td>
         <td class="hckui__typography__bodyL">
          <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"Seeed Studio Grove - Vibration Motor","href":"/seeed/products/grove-vibration-motor?ref=project-784142","type":"part","location":"things"},"clickOpts":{"delayRedirect":true}}' href="https://www.hackster.io/seeed/products/grove-vibration-motor?ref=project-784142">
           Seeed Studio Grove - Vibration Motor
          </a>
         </td>
        </tr>
        <tr>
         <td class="part-img">
          <img alt="BOOSTXL-ULN2003 ULN2003A Dual Stepper Motor BoosterPack" src="41.jpg" srcset="https://hackster.imgix.net/uploads/attachments/358682/boostxl-uln2003_boostxl_angle2.jpg?auto=compress%2Cformat&amp;w=96&amp;h=96&amp;fit=fill&amp;bg=ffffff 2x, https://hackster.imgix.net/uploads/attachments/358682/boostxl-uln2003_boostxl_angle2.jpg?auto=compress%2Cformat&amp;w=48&amp;h=48&amp;fit=fill&amp;bg=ffffff"/>
         </td>
         <td class="hckui__typography__bodyL">
          <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"Texas Instruments BOOSTXL-ULN2003 ULN2003A Dual Stepper Motor BoosterPack","href":"/texasinstruments/products/boostxl-uln2003-uln2003a-dual-stepper-motor-boosterpack?ref=project-784142","type":"part","location":"things"},"clickOpts":{"delayRedirect":true}}' href="https://www.hackster.io/texasinstruments/products/boostxl-uln2003-uln2003a-dual-stepper-motor-boosterpack?ref=project-784142">
           Texas Instruments BOOSTXL-ULN2003 ULN2003A Dual Stepper Motor BoosterPack
          </a>
         </td>
        </tr>
        <tr>
         <td class="part-img">
          <img alt="Laser Diode, Visible" src="42.jpg" srcset="https://hackster.imgix.net/uploads/attachments/836079/25M7537-40.jpg?auto=compress%2Cformat&amp;w=96&amp;h=96&amp;fit=fill&amp;bg=ffffff 2x, https://hackster.imgix.net/uploads/attachments/836079/25M7537-40.jpg?auto=compress%2Cformat&amp;w=48&amp;h=48&amp;fit=fill&amp;bg=ffffff"/>
         </td>
         <td class="hckui__typography__bodyL">
          Laser Diode, Visible
         </td>
        </tr>
        <tr>
         <td class="part-img">
          <img alt='Axial Fan, 10" Exhaust' src="43.jpg" srcset="https://hackster.imgix.net/uploads/attachments/830962/52M8820-40.jpg?auto=compress%2Cformat&amp;w=96&amp;h=96&amp;fit=fill&amp;bg=ffffff 2x, https://hackster.imgix.net/uploads/attachments/830962/52M8820-40.jpg?auto=compress%2Cformat&amp;w=48&amp;h=48&amp;fit=fill&amp;bg=ffffff"/>
         </td>
         <td class="hckui__typography__bodyL">
          Axial Fan, 10" Exhaust
         </td>
        </tr>
        <tr>
         <td class="part-img">
         </td>
         <td class="hckui__typography__bodyL">
          DFRobot Water Pump
         </td>
        </tr>
        <tr>
         <td class="part-img">
         </td>
         <td class="hckui__typography__bodyL">
          Hair Dryer 2000W Generic
         </td>
        </tr>
        <tr>
         <td class="part-img">
         </td>
         <td class="hckui__typography__bodyL">
          Plastic Portable Commode
         </td>
        </tr>
        <tr>
         <td class="part-img">
         </td>
         <td class="hckui__typography__bodyL">
          Flexible Pipes
         </td>
        </tr>
       </tr>
       <tr class="head">
        <td colspan="2">
         <h3 class="hckui__typography__h3">
          Software apps and online services
         </h3>
        </td>
       </tr>
       <tr>
        <td class="part-img">
         <img alt="PSoC Creator" src="44.jpg" srcset="https://hackster.imgix.net/uploads/image/file/122553/Creator_BannerImage_2_.jpg?auto=compress%2Cformat&amp;w=96&amp;h=96&amp;fit=fill&amp;bg=ffffff 2x, https://hackster.imgix.net/uploads/image/file/122553/Creator_BannerImage_2_.jpg?auto=compress%2Cformat&amp;w=48&amp;h=48&amp;fit=fill&amp;bg=ffffff"/>
        </td>
        <td class="hckui__typography__bodyL">
         <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"Cypress PSoC Creator","href":"/cypress/products/psoc-creator?ref=project-784142","type":"part","location":"things"},"clickOpts":{"delayRedirect":true}}' href="https://www.hackster.io/cypress/products/psoc-creator?ref=project-784142">
          Cypress PSoC Creator
         </a>
        </td>
       </tr>
       <tr class="head">
        <td colspan="2">
         <h3 class="hckui__typography__h3">
          Hand tools and fabrication machines
         </h3>
        </td>
       </tr>
       <tr>
        <td class="part-img">
         <img alt="Soldering iron (generic)" src="45.jpg" srcset="https://hackster.imgix.net/uploads/image/file/79853/09507-01.jpg?auto=compress%2Cformat&amp;w=96&amp;h=96&amp;fit=fill&amp;bg=ffffff 2x, https://hackster.imgix.net/uploads/image/file/79853/09507-01.jpg?auto=compress%2Cformat&amp;w=48&amp;h=48&amp;fit=fill&amp;bg=ffffff"/>
        </td>
        <td class="hckui__typography__bodyL">
         Soldering iron (generic)
        </td>
       </tr>
      </tbody>
     </table>
    </div>
   </div>
  </section>
  <div class="project-section-break">
  </div>
  <section id="story">
   <div class="project-section-title">
    <h2 class="hckui__typography__h2 title-with-anchor">
     <span>
      Story
     </span>
    </h2>
   </div>
   <div class="project-story collapsible-section collapsed hljs-active hljs-monokai" itemprop="text">
    <h3 class="hckui__typography__h3 title-with-anchor" id="toc-introduction-0">
     <p>
      <p class="hckui__typography__bodyL">
      </p>
     </p>
     <span>
      Introduction
     </span>
    </h3>
    <p class="hckui__typography__bodyL">
     Cap Sense touch-based user interface redefines user's interaction with tools and objects, making them more intuitive and user friendly to use. Here in this project, I am trying to develop a demo for Cap Sense based human-machine-interface that will upgrade the existing medical/portable commode with more options for the patients or users with visual/limited movement disabilities.
    </p>
    <p class="hckui__typography__bodyL">
     Caregivers can also operate this device and make their work a bit easier.
    </p>
    <h3 class="hckui__typography__h3 title-with-anchor" id="toc-features-1">
     <p>
      <p class="hckui__typography__bodyL">
      </p>
     </p>
     <span>
      Features
     </span>
    </h3>
    <ul class="hckui__typography__bodyL">
     <li>
      1. Aimed washing control
     </li>
     <li>
      2. Adjustable water flow control
     </li>
     <li>
      3. Privacy Mode with White Noise
     </li>
     <li>
      4. Hot Air Dryer
     </li>
     <li>
      5. Anti Numb Massage
     </li>
     <li>
      6. Odor Extraction Fan
     </li>
     <li>
      <span>
       7. Indication LED and OLED Display for feedback to user
      </span>
      <strong>
       (In Button LED)
      </strong>
     </li>
    </ul>
    <p class="hckui__typography__bodyL">
     This is how the final prototype looks like :
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="0.jpg"/>
    </div>
    <div class="carousel-images">
     <img class="carousel-image" src="1.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     Touch based HMI Controller made with Infineon PSoC 4 CapSense technology :
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="2.jpg"/>
    </div>
    <h3 class="hckui__typography__h3 title-with-anchor" id="toc-demonstration-video-2">
     <p>
      <p class="hckui__typography__bodyL">
      </p>
     </p>
     <span>
      Demonstration Video
     </span>
    </h3>
    <div class="embed-frame">
     <figure class="youtube">
      <iframe allowfullscreen="" frameborder="0" height="500" src="//www.youtube.com/embed/qghSQABBcDw?rel=0" style="margin: 10px auto; display: block;" width="75%">
      </iframe>
      <figcaption class="hckui__typography__textCenter hckui__typography__pebble hckui__typography__bodyS hckui__layout__marginTop10">
       CapSense Human Machine Interface Demo
      </figcaption>
     </figure>
    </div>
    <h3>
    </h3>
    <h3 class="hckui__typography__h3 title-with-anchor" id="toc-hardware-build-assembly-3">
     <p>
      <p class="hckui__typography__bodyL">
      </p>
     </p>
     <span>
      Hardware Build/Assembly
     </span>
    </h3>
    <p class="hckui__typography__bodyL">
     Everything is electrically connected according to the following Schematic :
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="3.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     <strong>
      PSoC 4 Microcontroller
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"CY8C4245AXI-483","href":"https://www.infineon.com/cms/en/product/microcontroller/32-bit-psoc-arm-cortex-microcontroller/psoc-4-32-bit-arm-cortex-m0-mcu/cy8c4245axi-483/","type":"story","location":"story"},"clickOpts":{"delayRedirect":true}}' href="https://www.infineon.com/cms/en/product/microcontroller/32-bit-psoc-arm-cortex-microcontroller/psoc-4-32-bit-arm-cortex-m0-mcu/cy8c4245axi-483/" rel="nofollow">
      CY8C4245AXI-483
     </a>
     <span>
      is an ARM Cortex M0 microcontroller with 32 KB Flash, 4 KB RAM, max operating frequency 48 MHz with 36 GPIOs.
     </span>
    </p>
    <p class="hckui__typography__bodyL">
     This little microcontroller from Infineon (originally from Cypress) is a powerhouse with lots of interesting features compared to most generic microcontrollers. IDAC, CapSense, Programmable Logic are 3 of its unique features.
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="4.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     This PSoC4 chip is still active and preferred for production design.
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      CapSense TouchInterface (Trackpad/Slider/Button)
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     CapSense Touch Interface is made of electrodes which are just exposed metal pads with certain patterns and shapes at first sight, but there is more going on under the hood.
    </p>
    <p class="hckui__typography__bodyL">
     (See reference section: CapSense Touch Interface design guide for details)
    </p>
    <blockquote>
     The size and spacing of the capacitive sensor are equally important to the sensor's performance. In addition to the size of the sensor, and its spacing relative to the ground plane, the type of ground plane used is very important. Since the parasitic capacitance of the sensor is related to the electric field's (e-field) path to the ground, it is important to choose a ground plane that limits the concentration of e-field lines with no conductive object present.
    </blockquote>
    <blockquote>
     <span>
      Source:
     </span>
     <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"https://en.wikipedia.org/wiki/Capacitive_sensing","href":"https://en.wikipedia.org/wiki/Capacitive_sensing","type":"story","location":"story"},"clickOpts":{"delayRedirect":true}}' href="https://en.wikipedia.org/wiki/Capacitive_sensing" rel="nofollow">
      https://en.wikipedia.org/wiki/Capacitive_sensing
     </a>
     <span>
      (Wikipedia)
     </span>
    </blockquote>
    <p class="hckui__typography__bodyL">
     I made my own CapSense sensors on an FR4 protoboard &amp; it looks like this:
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="5.jpg"/>
     <img class="carousel-image" src="6.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     It is made with copper tape, copper wire strand and lots of soldering wire.
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      Hatch Ground
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     Hatch patterned ground helps to isolate each sensor from its surrounding traces and confine the sensor's electric field into a close area.
    </p>
    <p class="hckui__typography__bodyL">
     I have made this flexible hatch ground with packaging tape and copper wire strands. It will enclose the whole circuit except the places where the CapSense electrodes are  exposed to overlay (plastic enclosure top).
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="7.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     Nevertheless, Infineon's CapSense Technology is very robust, hence sensing may work even without hatch ground (at least it worked without hatch ground in my setup). Still, production design must use proper ground hatch for long term reliability.
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      Plastic Enclosure &amp;Overlay
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     It was one of those moments, I wish I had a 3D printer to make a proper enclosure. Since, that is not the case, I had to improvise and turn a wristwatch box into the enclosure and overlay for these CapSense electrodes.
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="8.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     This box is made of ABS plastic, the overlay is 2mm thick plastic and it worked perfectly. I have dented 6 holes for LED indication lights and cutout for the OLED display.
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      OLED Display
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     This 1306 I2C 128x32 pixel display will show different confirmation messages to the user, as CapSense activity is detected, it will show up the latest mode info that was activated.
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="9.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     <strong>
      In-Button Indication LED
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     There are 6 LEDs, 1 Green, 2 Red and 3 Blue, right in the center of each touch button. These LEDs toggle every time their corresponding touch button is touched.
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="10.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     If an LED is glowing, it means the function attached to that button is active.
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      Servo Motors
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     There are two servo motors mounted on a Pan-and-Tilt-bracket mechanical device, which enables angular and rotational movements.
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="11.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     <span>
      A washing spray nozzle is mounted on this setup, user can use the
     </span>
     <strong>
      CapSense Trackpad
     </strong>
     <span>
      to aim at different regions for cleaning (please don't imagine it).
     </span>
    </p>
    <p class="hckui__typography__bodyL">
     Movement left-right on the trackpad will control the pan and up-down will control the tilt.
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      Vibration Motors
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     There are 4 vibration motors installed under the seat cover of the commode in parallel, along with 4 dot lasers (for visual indication)
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="12.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     When the anti-numb massage mode is activated by the user from the touch interface, these motors will vibrate and help user to counter numbness.
    </p>
    <p class="hckui__typography__bodyL">
     Some patients need to sit longer to get things done,  as the duration will vary according to each patients' health condition, hence this feature will ease their discomfort and numbness.
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      SprayPump Motor
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     The job of this pump is to spray water for washing, driven by a PWM signal to control the water flow rate.
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="13.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     <span>
      The user needs to provide input on the
     </span>
     <strong>
      CapSense Slider,
     </strong>
     <span>
      which will control the duty cycle of the PWM signal that drives the pump motor. ULN2803 driver chip is used to interface mcu with pump motor.
     </span>
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      Audio Playback Module
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     One of the biggest concerns with users of a medical commode is privacy, since they are responding to the 'call of nature' in an open environment.
    </p>
    <p class="hckui__typography__bodyL">
     Best way to block unwanted sounds is to use white noise to mask them. In this case, sounds such as rain/thunder sound, flowing water sound or static noise are used to enhance the experience.
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="14.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     <span>
      One tap on the
     </span>
     <strong>
      CapSense Button
     </strong>
     <span>
      associated to triggering Privacy Mode, the sound masking screen will be activated.
     </span>
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      Hair Dryer
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     Ideally, the final product should have a custom hot air dryer solution but for demonstration purposes, I am using Hair Dryer to show this feature.
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="15.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     The hot air temperature profile is suitable for human body application for short period. This feature will help reduce fungal infections in patients.
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      Exhaust Fan
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     Unpleasant odor is a serious privacy concern for the patients and severely discomfortable experience for others.
    </p>
    <p class="hckui__typography__bodyL">
     Typical exhaust fans remove the odor from the rooms atmosphere. But this solution removes odor both from the room and right from the spot.
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="16.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     It is vital to connect a duct pipe on the outlet of the exhaust fan but reason for not being able to shown is, I couldn't find the right size pipe for that.
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      Relay Module
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     There are two relay modules inside the AC socket box, just typical relays which will take logic level inputs, activate the coils, latch power to the load.
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="17.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     Whenever the user touches the correct CapSense buttons, the PSoC mcu will put logic high on the GPIOs which are connected to the signal inputs of the relays, activating them and powering up AC loads.
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      Power Supply
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     Clean power supply (minimum ripple, less noise) is very important for CapSense sensitivity. I have observed that when the project is powered from cleaner DC source like Battery or Solar, the touch sensitivity increases compared to powering from an wall adapter. I have used a 5V DC phone adapter to power this demo.
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      Wiring and Plumbing
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     There are the 3 holes inside the commode chamber:
    </p>
    <ul class="hckui__typography__bodyL">
     <li>
      To supply water for aimed (by 2 servos) spraying system
     </li>
     <li>
      To remove odor (from the spot) by creating partial vacuum with exhaust fan
     </li>
     <li>
      To supply hot air from air heater (dryer) to for drying
     </li>
    </ul>
    <div class="carousel-images">
     <img class="carousel-image" src="18.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     The wiring and plumbing is bit of a mess:-
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="19.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     But this also demonstrates how solid performing the CapSense Technology from Infineon is ! It works under the worst case scenario !
    </p>
    <p class="hckui__typography__bodyL">
     With proper wiring, plumbing, shielding and layout design, the system performance can be much more stable, robust and reliable for longer operation.
    </p>
    <h3 class="hckui__typography__h3 title-with-anchor" id="toc-psoc4-creator-ide--device-configurations-4">
     <p>
      <p class="hckui__typography__bodyL">
      </p>
     </p>
     <span>
      PSoC4 Creator IDE: Device Configurations
     </span>
    </h3>
    <p class="hckui__typography__bodyL">
     <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"PSoC Creator","href":"https://www.infineon.com/cms/en/design-support/tools/sdk/psoc-software/psoc-creator/","type":"story","location":"story"},"clickOpts":{"delayRedirect":true}}' href="https://www.infineon.com/cms/en/design-support/tools/sdk/psoc-software/psoc-creator/" rel="nofollow">
      PSoC Creator
     </a>
     <span>
      is an interesting IDE to develop CapSense solutions with PSoC 4 devices (e.g. CY8C4245AXI-483)
     </span>
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      FirmwareDevelopment workflow
     </strong>
     <span>
      in PSoC Creator can be segmented into 3 interconnected sections :
     </span>
    </p>
    <ul class="hckui__typography__bodyL">
     <li>
      <strong>
       1. TopDesign.cysch
      </strong>
     </li>
     <li>
      <strong>
       2. &lt;Project_name&gt;.cydwr
      </strong>
     </li>
     <li>
      <strong>
       3. main.c
      </strong>
     </li>
    </ul>
    <p class="hckui__typography__bodyL">
     <span>
      TopDesign.cysch is the
     </span>
     <strong>
      drag and drop schematic interface
     </strong>
     <span>
      to pick
     </span>
     <strong>
      hardware blocks
     </strong>
     <span>
      and
     </span>
     <strong>
      configure
     </strong>
     <span>
      them, even add
     </span>
     <strong>
      programmable logic
     </strong>
     <span>
      and
     </span>
     <strong>
      modify internal hardware routing
     </strong>
     <span>
      as needed
     </span>
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="20.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     <span>
      From the
     </span>
     <strong>
      component catalog
     </strong>
     <span>
      , all the required components like CapSense, PWM, GPIO, I2C can be placed on the TopDesign.cysch page
     </span>
    </p>
    <p class="hckui__typography__bodyL">
     <span>
      On the &lt;ProjectName&gt;.cydwr tab, developer needs to
     </span>
     <strong>
      assign GPIOs/real physical pins
     </strong>
     <span>
      of the
     </span>
     <strong>
      mcu
     </strong>
     <span>
      and
     </span>
     <strong>
      map
     </strong>
     <span>
      them with the
     </span>
     <strong>
      hardware blocks in cysch
     </strong>
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="21.jpg"/>
    </div>
    <h3>
    </h3>
    <p class="hckui__typography__bodyL">
     <span>
      After configuring these two segments,
     </span>
     <strong>
      building the project
     </strong>
     <span>
      will
     </span>
     <strong>
      generate
     </strong>
     <span>
      the necessary
     </span>
     <strong>
      APIs (functions) for all the hardware component
     </strong>
     <span>
      , the API names will depend on how the components were named first.
     </span>
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      In the main.c, code is written using these generated APIs
     </strong>
     <span>
      , then
     </span>
     <strong>
      compiled, flashed, debugged and modified/repeated
     </strong>
     <span>
      , until the desired results are achieved.
     </span>
    </p>
    <p class="hckui__typography__bodyL">
     <span>
      Each component placed on
     </span>
     <strong>
      TopDesig, cysch
     </strong>
     <span>
      needs to be
     </span>
     <strong>
      configured properly
     </strong>
     <span>
      by
     </span>
     <strong>
      clicking on them
     </strong>
     <span>
      and providing required
     </span>
     <strong>
      settings/parameters/values
     </strong>
     <span>
      for them.
     </span>
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      <em>
       Configuring PSoCComponents
      </em>
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      Bootloadable
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     <span>
      This
     </span>
     <strong>
      Bootloadable
     </strong>
     <span>
      component allows the MCU to be
     </span>
     <strong>
      reprogrammed/flashed through a simple UART
     </strong>
     <span>
      interface, no dedicated programmer/debugger is required.
     </span>
    </p>
    <p class="hckui__typography__bodyL">
     <span>
      By linking
     </span>
     <strong>
      UART_Bootloader.hex
     </strong>
     <span>
      file in this component, necessary start-up instructions are put at the
     </span>
     <strong>
      beginning of program memory
     </strong>
     <span>
      , allowing reprogramming of the application.
     </span>
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="22.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     <span>
      During startup of power cycle if
     </span>
     <em>
      <strong>
       Pin 0_7
      </strong>
     </em>
     <span>
      is pulled down to Gnd, the PSoC chip/mcu will execute the bootloader code and enter bootloader mode. In this mode
     </span>
     <strong>
      <em>
       Blue LED on Pin 1_6
      </em>
     </strong>
     <span>
      keep flashing a 1 Hz and ready to accept latest application code flashing through UART.
     </span>
    </p>
    <p class="hckui__typography__bodyL">
     <span>
      If
     </span>
     <strong>
      <em>
       Pin 0_7
      </em>
     </strong>
     <span>
      is not pulled down during start up/restart/power cycling, mcu will not enter bootloader mode but directly run the actual application code.
     </span>
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      CapSense
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     <span>
      CapSense component is the core component for enabling CapSensing features on PSoC chip. In the
     </span>
     <strong>
      Basic
     </strong>
     <span>
      tab by clicking on the "+" different types of CapSensing interfaces like Touchpad/Slider/Buttons can be added to the program.
     </span>
    </p>
    <p class="hckui__typography__bodyL">
     Note that, each interface will occupy certain number of GPIO pins depending on their configuration.
    </p>
    <p class="hckui__typography__bodyL">
     Here is how I configured the CapSense for this project :-
    </p>
    <ul class="hckui__typography__bodyL">
     <li>
      Touchpad with 3 Columns and 4 Rows, that will need total 7 GPIOs/pins
     </li>
     <li>
      Linear Slider with 3 segments which will require 3 more GPIOs/pins
     </li>
     <li>
      6 Touch Buttons each will need 1 pins, total 6 GPIOs for 6 Buttons
     </li>
    </ul>
    <div class="carousel-images">
     <img class="carousel-image" src="23.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     <span>
      All the cap sensing elements are configured for
     </span>
     <strong>
      self-capacitance
     </strong>
     <span>
      mode with
     </span>
     <strong>
      smart sense(hardware parameter) tuning
     </strong>
     <span>
      . This allows selecting a
     </span>
     <strong>
      finger-capacitance threshold
     </strong>
     <span>
      as low as
     </span>
     <strong>
      0.02 pF
     </strong>
     <span>
      , which enables the use of
     </span>
     <strong>
      thick plastic overlay
     </strong>
     <span>
      (a few mm thick) on top of cap sense electrodes.
     </span>
    </p>
    <p class="hckui__typography__bodyL">
     Physical pins for these CapSense electrodes are assigned on the CYDWR tab as follows :
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="24.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     <strong>
      I2COLED
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     I2C OLED is an I2C component configured to drive 1306 OLED display in Master mode @ 100kbps speed.
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="25.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     I am using the following library from GitHub to drive the OLED Module:
    </p>
    <p class="hckui__typography__bodyL">
     <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"https://github.com/derkst/Cypress-PSOC-OLED","href":"https://github.com/derkst/Cypress-PSOC-OLED","type":"story","location":"story"},"clickOpts":{"delayRedirect":true}}' href="https://github.com/derkst/Cypress-PSOC-OLED" rel="nofollow">
      https://github.com/derkst/Cypress-PSOC-OLED
     </a>
    </p>
    <p class="hckui__typography__bodyL">
     The I2C component is very old, so it is necessary to update the component to get it working on PSoC Creator 4.4. The library is a port of Adafruit_GFX library.
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      Updating I2C OLED component
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     To update the I2C OLED component, from PSoC Creator menu :
    </p>
    <p class="hckui__typography__bodyL">
     <em>
      <strong>
       project &gt; update component
      </strong>
     </em>
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="26.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     <span>
      Then select
     </span>
     <strong>
      Next
     </strong>
     <span>
      , some download will happen and the components will be updated to the latest version.
     </span>
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      ServoControlPWM
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     To control 2 servo motors two separate PWM modules are configured to generate 50 Hz square wave pulse control signal, enabling independent and simultaneous position control.
    </p>
    <p class="hckui__typography__bodyL">
     Servo position is controlled by varying duty cycle of the PWM signals between 5% to 10%.
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="27.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     <span>
      This is done by
     </span>
     <strong>
      varying the Compare Register
     </strong>
     <span>
      values on the fly depending on the
     </span>
     <strong>
      user's finger position
     </strong>
     <span>
      on the
     </span>
     <strong>
      CapSense touchpad
     </strong>
     <span>
      .
     </span>
    </p>
    <p class="hckui__typography__bodyL">
     Changing the Value of Period between "1 to 65535", will vary the PWM Frequency.
    </p>
    <p class="hckui__typography__bodyL">
     Changing the Value of Compare between "1 to Period Value", will vary the Duty Cycle.
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      <em>
       Formula
      </em>
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      Period = Clock / (2 X Desired Frequency )
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      Compare = Period - ( Desired Duty X Period )
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      <em>
       Calculating Frequency and Duty Cycle
      </em>
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     Here, Clock speed for the PWM Component is chosen 480 kHz,
    </p>
    <p class="hckui__typography__bodyL">
     To generate a PWM signal of 50 Hz (Desired Frequency )
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      <em>
       Period Register value will be, 480000 / ( 2 X 50 ) = 4800
      </em>
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      <em>
       Compare Register (min) value will be, 4800 - ( 10% X 4800 ) = 4320
      </em>
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      <em>
       Compare Register (max) value will be, 4800 - ( 5% X 4800 ) = 4560
      </em>
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     By varying the Compare Register value between 4320 to 4560, the servo motor position can be controlled, because it will generate the desired signal with right duty cycle and frequency
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      PWMModuleClock:
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     Clock component will generate user configurable clock signal for PWM module.
    </p>
    <p class="hckui__typography__bodyL">
     Changing the Value of Clock signal to PWM component, will vary the Frequency range. The faster the clock, the higher is the max frequency.
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="28.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     <strong>
      ServoDrivePWMOutput:
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     <span>
      The PWM signal produced from PWM module is diverted to a Output pin to bring out the signal from the chip. This output pin is driven by the PWM module (i.e hardware driven), so they must be
     </span>
     <strong>
      connected or wired in cysch
     </strong>
     <span>
      and
     </span>
     <strong>
      hardware connection
     </strong>
     <span>
      needs to be enabled in configuration.
     </span>
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="29.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     <span>
      The output signal is
     </span>
     <strong>
      digital
     </strong>
     <span>
      type and drive mode is selected to be
     </span>
     <strong>
      strong drive
     </strong>
     <span>
      .
     </span>
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      LEDsandExternalDevicesDriveOutputs:
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     To drive 6 status LEDs and 4 external loads, total 10 GPIOs are configures as digital output with strong drive.
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="30.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     Since, these pins are controlled from firmware directly (i.e. purely software driven), HW connection is unchecked in the configuration settings.
    </p>
    <h3 class="hckui__typography__h3 title-with-anchor" id="toc-writing-firmware-and-programming-5">
     <p>
      <p class="hckui__typography__bodyL">
      </p>
     </p>
     <span>
      Writing Firmware and Programming
     </span>
    </h3>
    <p class="hckui__typography__bodyL">
     <span>
      In PSoC Creator IDE, firmware or
     </span>
     <strong>
      code can be written on the main.c
     </strong>
     <span>
      file after all the hardware block/components are configured properly and the project is build.
     </span>
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      Build &gt; (project name)
     </strong>
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="31.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     <span>
      Because
     </span>
     <strong>
      building the project will generate necessary APIs or functions to control the hardware blocks
     </strong>
     <span>
      like CapSense, PWM, GPIO etc.
     </span>
     <strong>
      API documentations
     </strong>
     <span>
      can be found by
     </span>
     <strong>
      clicking on each component
     </strong>
     <span>
      and opening their respective datasheets.
     </span>
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="32.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     Once the firmware is written, it can be flashed on the PSoC chip or mcu using bootloader host application.
    </p>
    <p class="hckui__typography__bodyL">
     <span>
      Find the
     </span>
     <strong>
      your_project_name.cyacd
     </strong>
     <span>
      file from bootloader host and select it, then set baud rate 11500 and click the program icon to flash the firmware
     </span>
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="33.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     <em>
      <code>
       cyacd file location: C:\Users\(Your Computer Name)\(Your Project Location)\(Your Project Directory Name)\CortexM0\ARM_GCC_541\Debug
      </code>
     </em>
    </p>
    <p class="hckui__typography__bodyL">
     <span>
      I am using
     </span>
     <strong>
      HC-05 module to wirelessly program the PSoC 4
     </strong>
     <span>
      mcu, because it saves the trouble of connecting the microcontroller to PC USB again and again for bug fixing and updating the firmware.
     </span>
    </p>
    <p class="hckui__typography__bodyL">
     <span>
      Please check out my other project on how to do it
     </span>
     <strong>
      Wireless PSoC Programming
     </strong>
     <span>
      in details :
     </span>
    </p>
    <p class="hckui__typography__bodyL">
     <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"https://www.hackster.io/PSoC_Rocks/psoc-4-wireless-programming-496f60","href":"https://www.hackster.io/PSoC_Rocks/psoc-4-wireless-programming-496f60","type":"story","location":"story"},"clickOpts":{"delayRedirect":true}}' href="https://www.hackster.io/PSoC_Rocks/psoc-4-wireless-programming-496f60" rel="nofollow">
      https://www.hackster.io/PSoC_Rocks/psoc-4-wireless-programming-496f60
     </a>
    </p>
    <h3 class="hckui__typography__h3 title-with-anchor" id="toc-conclusion-6">
     <p>
      <p class="hckui__typography__bodyL">
      </p>
     </p>
     <span>
      Conclusion
     </span>
    </h3>
    <p class="hckui__typography__bodyL">
     This project is a demonstration of Infineon CapSense technology, it's not necessarily a demo for advanced medical commode. The purpose of this project is to showcase CapSense technology, which can improve an existing object or tools.
    </p>
    <p class="hckui__typography__bodyL">
     This design is far from a finished product, more work needs to be done to improve it. This is as far as I can do myself  by 'making something' at home with limited budget, time and skill.
    </p>
    <h3>
    </h3>
    <h3 class="hckui__typography__h3 title-with-anchor" id="toc-references-7">
     <p>
      <p class="hckui__typography__bodyL">
      </p>
     </p>
     <span>
      References
     </span>
    </h3>
    <ul class="hckui__typography__bodyL">
     <li>
      <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"Capacitive Sensing Technology","href":"https://en.wikipedia.org/wiki/Capacitive_sensing","type":"story","location":"story"},"clickOpts":{"delayRedirect":true}}' href="https://en.wikipedia.org/wiki/Capacitive_sensing" rel="nofollow">
       Capacitive Sensing Technology
      </a>
     </li>
     <li>
      <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"Infineon CapSense Desing Guide","href":"https://www.infineon.com/dgdl/Infineon-AN85951_PSoC_4_and_PSoC_6_MCU_CapSense_Design_Guide-ApplicationNotes-v29_00-EN.pdf?fileId=8ac78c8c7cdc391c017d0723535d4661","type":"story","location":"story"},"clickOpts":{"delayRedirect":true}}' href="https://www.infineon.com/dgdl/Infineon-AN85951_PSoC_4_and_PSoC_6_MCU_CapSense_Design_Guide-ApplicationNotes-v29_00-EN.pdf?fileId=8ac78c8c7cdc391c017d0723535d4661" rel="nofollow">
       Infineon CapSense Desing Guide
      </a>
     </li>
     <li>
      <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"Getting Started with PSoC Creator IDE","href":"https://www.infineon.com/dgdl/Infineon-PSoC_Creator_Quick_Start_Guide-UserManual-v18_00-EN.pdf?fileId=8ac78c8c7ddc01d7017ddd05ccd65a4c\u0026utm_source=cypress\u0026utm_medium=referral\u0026utm_campaign=202110_globe_en_all_integration-files","type":"story","location":"story"},"clickOpts":{"delayRedirect":true}}' href="https://www.infineon.com/dgdl/Infineon-PSoC_Creator_Quick_Start_Guide-UserManual-v18_00-EN.pdf?fileId=8ac78c8c7ddc01d7017ddd05ccd65a4c&amp;utm_source=cypress&amp;utm_medium=referral&amp;utm_campaign=202110_globe_en_all_integration-files" rel="nofollow">
       Getting Started with PSoC Creator IDE
      </a>
     </li>
     <li>
      <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"Learning basic techniques for PSoC Creator programming","href":"http://youtube.com/watch?v=wttaZVbmBI8\u0026list=PLIOkqhZiy83F8KPvHejA4ujvAfwJYpAtP","type":"story","location":"story"},"clickOpts":{"delayRedirect":true}}' href="http://youtube.com/watch?v=wttaZVbmBI8&amp;list=PLIOkqhZiy83F8KPvHejA4ujvAfwJYpAtP" rel="nofollow">
       Learning basic techniques for PSoC Creator programming
      </a>
     </li>
     <li>
      <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"GFX Library","href":"https://learn.adafruit.com/adafruit-gfx-graphics-library","type":"story","location":"story"},"clickOpts":{"delayRedirect":true}}' href="https://learn.adafruit.com/adafruit-gfx-graphics-library" rel="nofollow">
       GFX Library
      </a>
     </li>
     <li>
      <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"OLED Display with PSoC 4","href":"https://github.com/derkst/Cypress-PSOC-OLED","type":"story","location":"story"},"clickOpts":{"delayRedirect":true}}' href="https://github.com/derkst/Cypress-PSOC-OLED" rel="nofollow">
       OLED Display with PSoC 4
      </a>
     </li>
    </ul>
   </div>
  </section>
  <div class="project-section-break">
  </div>
  <section id="schematics">
   <div class="project-section-title">
    <h2 class="hckui__typography__h2 title-with-anchor">
     <span>
      Schematics
     </span>
    </h2>
   </div>
   <div class="project-attachment">
    <div class="header">
     <div class="text">
      <h3 class="hckui__typography__h3">
       sch int
      </h3>
      <div class="hckui__typography__bodyS hckui__typography__pebble">
       PSoC Internal Schematic
      </div>
     </div>
    </div>
    <div class="embed original boxed hckui__typography__textCenter">
     <img src="46.jpg"/>
    </div>
   </div>
   <div class="project-attachment">
    <div class="header">
     <div class="text">
      <h3 class="hckui__typography__h3">
       sch_final_corrv1_veHabqF3TD.bmp
      </h3>
     </div>
    </div>
    <div class="embed original boxed hckui__typography__textCenter">
     <img src="47.jpg"/>
    </div>
   </div>
  </section>
  <div class="project-section-break">
  </div>
  <section id="code">
   <div class="project-section-title">
    <h2 class="hckui__typography__h2 title-with-anchor">
     <span>
      Code
     </span>
    </h2>
   </div>
   <div class="project-attachment project-code-widget">
    <div class="tabs hckui__typography__bodyS">
     <ul>
      <li class="active">
       <a data-target="#code-widget-639094" href="javascript:void(0)">
        main.c
       </a>
      </li>
      <li>
       <a data-target="#code-widget-639743" href="javascript:void(0)">
        full code
       </a>
      </li>
     </ul>
    </div>
    <div class="preview-container">
     <div class="preview-pane active" id="code-widget-639094">
      <div class="header">
       <div class="text">
        <div class="title">
         <h3 class="hckui__typography__h3">
          main.c
         </h3>
         <span class="hckui__typography__bodyS hckui__typography__pebble">
          C/C++
         </span>
        </div>
        <div class="comment">
         <div class="hckui__typography__bodyS hckui__typography__pebble">
          final code (bug fixed)
         </div>
        </div>
       </div>
      </div>
      <div class="preview-body pygments-syntax all">
       <div class="highlight">
        <pre><span></span><span id="line-1"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;project.h&gt;</span><span class="cp"></span>
</span><span id="line-2"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
</span><span id="line-3"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
</span><span id="line-4"><span class="cp">#include</span><span class="w"> </span><span class="cpf">"ssd1306.h"</span><span class="cp"></span>
</span><span id="line-5">
</span><span id="line-6"><span class="cp">#define DISPLAY_ADDRESS 0x3C </span><span class="c1">// I2C Oled address 0x3C</span>
</span><span id="line-7">
</span><span id="line-8"><span class="kt">uint8_t</span><span class="w"> </span><span class="n">which_button</span><span class="p">;</span><span class="w"> </span><span class="c1">// keeps track of which button is touched</span>
</span><span id="line-9"><span class="kt">uint8_t</span><span class="w"> </span><span class="n">wash_speed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">//  finger position on linear slider</span>
</span><span id="line-10"><span class="kt">uint16_t</span><span class="w"> </span><span class="n">x_pos</span><span class="p">;</span><span class="w"> </span><span class="c1">//  x position of finger on trackpad</span>
</span><span id="line-11"><span class="kt">uint16_t</span><span class="w"> </span><span class="n">y_pos</span><span class="p">;</span><span class="w"> </span><span class="c1">//  y position of finger on trackpad</span>
</span><span id="line-12">
</span><span id="line-13">
</span><span id="line-14"><span class="c1">// following function will display text msg on OLED screen //</span>
</span><span id="line-15">
</span><span id="line-16"><span class="kt">void</span><span class="w"> </span><span class="nf">show_info_on_OLED</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">line1</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span><span class="kt">char</span><span class="w"> </span><span class="n">line2</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span><span class="w"></span>
</span><span id="line-17"><span class="p">{</span><span class="w"></span>
</span><span id="line-18"><span class="w">        </span><span class="n">display_clear</span><span class="p">();</span><span class="w">    </span>
</span><span id="line-19"><span class="w">        </span><span class="n">gfx_setCursor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span><span class="w"></span>
</span><span id="line-20"><span class="w">        </span><span class="n">gfx_print</span><span class="p">(</span><span class="n">line1</span><span class="p">);</span><span class="w"></span>
</span><span id="line-21"><span class="w">        </span><span class="n">gfx_setCursor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">32</span><span class="p">);</span><span class="w"></span>
</span><span id="line-22"><span class="w">        </span><span class="n">gfx_print</span><span class="p">(</span><span class="n">line2</span><span class="p">);</span><span class="w"></span>
</span><span id="line-23"><span class="w">        </span><span class="n">display_update</span><span class="p">();</span><span class="w"></span>
</span><span id="line-24"><span class="w">    </span>
</span><span id="line-25"><span class="p">}</span><span class="w"></span>
</span><span id="line-26">
</span><span id="line-27"><span class="c1">// main loop</span>
</span><span id="line-28">
</span><span id="line-29"><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
</span><span id="line-30"><span class="p">{</span><span class="w"></span>
</span><span id="line-31"><span class="w">    </span><span class="c1">// Start I2C to drive OLED display</span>
</span><span id="line-32"><span class="w">    </span><span class="n">I2COLED_Start</span><span class="p">();</span><span class="w"></span>
</span><span id="line-33"><span class="w">    </span>
</span><span id="line-34"><span class="w">    </span><span class="c1">// start 2 PWM blocks to control servos </span>
</span><span id="line-35"><span class="w">    </span><span class="n">PWM_1_Start</span><span class="p">();</span><span class="w"></span>
</span><span id="line-36"><span class="w">    </span><span class="n">PWM_2_Start</span><span class="p">();</span><span class="w"></span>
</span><span id="line-37"><span class="w">    </span><span class="c1">//PWM_3_Start();</span>
</span><span id="line-38"><span class="w">    </span>
</span><span id="line-39"><span class="w">    </span><span class="c1">// enable global interrupt</span>
</span><span id="line-40"><span class="w">    </span><span class="n">CyGlobalIntEnable</span><span class="p">;</span><span class="w"></span>
</span><span id="line-41"><span class="w">    </span>
</span><span id="line-42"><span class="w">    </span><span class="c1">// start capsense and set baseline for parasitic capacitance compensation</span>
</span><span id="line-43"><span class="w">    </span><span class="n">CapSense_Start</span><span class="p">();</span><span class="w"></span>
</span><span id="line-44"><span class="w">    </span><span class="n">CapSense_InitializeAllBaselines</span><span class="p">();</span><span class="w"></span>
</span><span id="line-45"><span class="w">    </span><span class="c1">// Baseline is critical for proper operation of capsense</span>
</span><span id="line-46"><span class="w">    </span><span class="c1">// when this function is doing its thing, do not touch anything !</span>
</span><span id="line-47"><span class="w">    </span>
</span><span id="line-48"><span class="w">    </span><span class="c1">// init OLED display and set font, orientation, color</span>
</span><span id="line-49"><span class="w">    </span><span class="n">display_init</span><span class="p">(</span><span class="n">DISPLAY_ADDRESS</span><span class="p">);</span><span class="w"></span>
</span><span id="line-50"><span class="w">    </span><span class="n">gfx_setRotation</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
</span><span id="line-51"><span class="w">    </span><span class="n">gfx_setTextSize</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span><span class="w">   </span>
</span><span id="line-52"><span class="w">    </span><span class="n">gfx_setTextColor</span><span class="p">(</span><span class="n">WHITE</span><span class="p">);</span><span class="w"></span>
</span><span id="line-53"><span class="w">    </span>
</span><span id="line-54"><span class="w">          </span><span class="c1">/// welcome message /// </span>
</span><span id="line-55"><span class="w">    </span><span class="c1">//    show_info_on_OLED("CAPSENS"," PSOC 4");</span>
</span><span id="line-56"><span class="w">    </span><span class="c1">//    CyDelay(2000);</span>
</span><span id="line-57"><span class="w">    </span><span class="c1">//    show_info_on_OLED(" TOUCH ","CONTROL");    </span>
</span><span id="line-58"><span class="w">            </span>
</span><span id="line-59"><span class="w">        </span>
</span><span id="line-60"><span class="w">    </span><span class="k">for</span><span class="p">(;;)</span><span class="w"></span>
</span><span id="line-61"><span class="p">{</span><span class="w"></span>
</span><span id="line-62">
</span><span id="line-63"><span class="w">        </span>
</span><span id="line-64"><span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">CapSense_IsBusy</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
</span><span id="line-65"><span class="w">        </span><span class="p">{</span><span class="w"></span>
</span><span id="line-66"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="c1">// wait until something is being sensed on capsense electrodes    </span>
</span><span id="line-67"><span class="w">         </span>
</span><span id="line-68"><span class="w">          </span><span class="c1">// process all capsense interfaces/sensors</span>
</span><span id="line-69"><span class="w">            </span><span class="n">CapSense_ProcessAllWidgets</span><span class="p">();</span><span class="w"></span>
</span><span id="line-70"><span class="w">            </span><span class="n">CapSense_IsAnyWidgetActive</span><span class="p">();</span><span class="w"></span>
</span><span id="line-71"><span class="w">        </span>
</span><span id="line-72"><span class="w">        </span><span class="c1">// get latest finger position on touchpad </span>
</span><span id="line-73"><span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">CapSense_IsWidgetActive</span><span class="p">(</span><span class="n">CapSense_TOUCHPAD0_WDGT_ID</span><span class="p">))</span><span class="w"> </span>
</span><span id="line-74"><span class="w">        </span><span class="p">{</span><span class="w"></span>
</span><span id="line-75"><span class="w">        </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">xy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CapSense_GetXYCoordinates</span><span class="p">(</span><span class="n">CapSense_TOUCHPAD0_WDGT_ID</span><span class="p">);</span><span class="w"></span>
</span><span id="line-76"><span class="w">        </span><span class="n">show_info_on_OLED</span><span class="p">(</span><span class="s">" AIMING"</span><span class="p">,</span><span class="s">" NOZZLE"</span><span class="p">);</span><span class="w"></span>
</span><span id="line-77"><span class="w">                </span>
</span><span id="line-78"><span class="w">        </span><span class="c1">// separate xy coordinate of finger pos on touchpad </span>
</span><span id="line-79"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">xy</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mh">0xFFFF</span><span class="p">)</span><span class="w"></span>
</span><span id="line-80"><span class="w">            </span><span class="p">{</span><span class="w"></span>
</span><span id="line-81"><span class="w">            </span><span class="n">y_pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xy</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">16</span><span class="p">;</span><span class="w"></span>
</span><span id="line-82"><span class="w">            </span><span class="n">x_pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">uint16</span><span class="p">)</span><span class="n">xy</span><span class="p">;</span><span class="w"> </span>
</span><span id="line-83"><span class="w">            </span><span class="p">}</span><span class="w"></span>
</span><span id="line-84">
</span><span id="line-85"><span class="w">        </span><span class="p">}</span><span class="w"></span>
</span><span id="line-86"><span class="w">        </span>
</span><span id="line-87"><span class="w">        </span>
</span><span id="line-88"><span class="w">    </span><span class="c1">// process touch buttons pressed by user and perform operation</span>
</span><span id="line-89"><span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">CapSense_IsWidgetActive</span><span class="p">(</span><span class="n">CapSense_BUTTON0_WDGT_ID</span><span class="p">))</span><span class="w"> </span>
</span><span id="line-90"><span class="w">        </span><span class="p">{</span><span class="w"></span>
</span><span id="line-91"><span class="w">        </span><span class="n">which_button</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
</span><span id="line-92"><span class="w">        </span><span class="n">show_info_on_OLED</span><span class="p">(</span><span class="s">"HOT AIR"</span><span class="p">,</span><span class="s">" DRYER"</span><span class="p">);</span><span class="w"></span>
</span><span id="line-93"><span class="w">        </span><span class="n">Hot_Air_Dryer_Write</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">Hot_Air_Dryer_Read</span><span class="p">()));</span><span class="w"></span>
</span><span id="line-94"><span class="w">        </span><span class="n">ButtonLED2_Write</span><span class="p">(</span><span class="o">!</span><span class="n">ButtonLED2_Read</span><span class="p">());</span><span class="w"></span>
</span><span id="line-95"><span class="w">        </span><span class="n">CyDelay</span><span class="p">(</span><span class="mi">700</span><span class="p">);</span><span class="w"></span>
</span><span id="line-96"><span class="w">        </span><span class="p">}</span><span class="w">    </span>
</span><span id="line-97"><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">CapSense_IsWidgetActive</span><span class="p">(</span><span class="n">CapSense_BUTTON1_WDGT_ID</span><span class="p">))</span><span class="w"></span>
</span><span id="line-98"><span class="w">        </span><span class="p">{</span><span class="w"></span>
</span><span id="line-99"><span class="w">        </span><span class="n">which_button</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
</span><span id="line-100"><span class="w">        </span><span class="n">show_info_on_OLED</span><span class="p">(</span><span class="s">"ENABLE"</span><span class="p">,</span><span class="s">"WASHING"</span><span class="p">);</span><span class="w"></span>
</span><span id="line-101"><span class="w">        </span><span class="n">ButtonLED6_Write</span><span class="p">(</span><span class="o">!</span><span class="n">ButtonLED6_Read</span><span class="p">());</span><span class="w"></span>
</span><span id="line-102"><span class="w">        </span><span class="n">CyDelay</span><span class="p">(</span><span class="mi">700</span><span class="p">);</span><span class="w"></span>
</span><span id="line-103"><span class="w">        </span><span class="p">}</span><span class="w">    </span>
</span><span id="line-104"><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">CapSense_IsWidgetActive</span><span class="p">(</span><span class="n">CapSense_BUTTON2_WDGT_ID</span><span class="p">))</span><span class="w"></span>
</span><span id="line-105"><span class="w">        </span><span class="p">{</span><span class="w"></span>
</span><span id="line-106"><span class="w">        </span><span class="n">which_button</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">              </span>
</span><span id="line-107"><span class="w">        </span><span class="n">show_info_on_OLED</span><span class="p">(</span><span class="s">"DISABLE"</span><span class="p">,</span><span class="s">"WASHING"</span><span class="p">);</span><span class="w"></span>
</span><span id="line-108"><span class="w">       </span><span class="c1">// ButtonLED5_Write(!ButtonLED5_Read());</span>
</span><span id="line-109"><span class="w">       </span><span class="n">CyDelay</span><span class="p">(</span><span class="mi">700</span><span class="p">);</span><span class="w"></span>
</span><span id="line-110"><span class="w">  </span>
</span><span id="line-111"><span class="w">        </span><span class="p">}</span><span class="w">    </span>
</span><span id="line-112"><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">CapSense_IsWidgetActive</span><span class="p">(</span><span class="n">CapSense_BUTTON3_WDGT_ID</span><span class="p">))</span><span class="w"></span>
</span><span id="line-113"><span class="w">        </span><span class="p">{</span><span class="w"></span>
</span><span id="line-114"><span class="w">        </span><span class="n">which_button</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
</span><span id="line-115"><span class="w">        </span><span class="n">show_info_on_OLED</span><span class="p">(</span><span class="s">"ANTINUM"</span><span class="p">,</span><span class="s">"MASSAGE"</span><span class="p">);</span><span class="w"></span>
</span><span id="line-116"><span class="w">        </span><span class="n">Anti_Numb_Massage_Write</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">Anti_Numb_Massage_Read</span><span class="p">()));</span><span class="w"></span>
</span><span id="line-117"><span class="w">        </span><span class="n">ButtonLED1_Write</span><span class="p">(</span><span class="o">!</span><span class="n">ButtonLED1_Read</span><span class="p">());</span><span class="w"></span>
</span><span id="line-118"><span class="w">        </span><span class="n">CyDelay</span><span class="p">(</span><span class="mi">700</span><span class="p">);</span><span class="w"></span>
</span><span id="line-119"><span class="w">        </span><span class="p">}</span><span class="w">    </span>
</span><span id="line-120"><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">CapSense_IsWidgetActive</span><span class="p">(</span><span class="n">CapSense_BUTTON4_WDGT_ID</span><span class="p">))</span><span class="w"></span>
</span><span id="line-121"><span class="w">        </span><span class="p">{</span><span class="w"></span>
</span><span id="line-122"><span class="w">        </span><span class="n">which_button</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
</span><span id="line-123"><span class="w">        </span><span class="n">show_info_on_OLED</span><span class="p">(</span><span class="s">"NO ODOR"</span><span class="p">,</span><span class="s">"EXT FAN"</span><span class="p">);</span><span class="w"></span>
</span><span id="line-124"><span class="w">        </span><span class="n">Odor_Extractor_Fan_Write</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">Odor_Extractor_Fan_Read</span><span class="p">()));</span><span class="w"></span>
</span><span id="line-125"><span class="w">        </span><span class="n">ButtonLED3_Write</span><span class="p">(</span><span class="o">!</span><span class="n">ButtonLED3_Read</span><span class="p">());</span><span class="w"></span>
</span><span id="line-126"><span class="w">        </span><span class="n">CyDelay</span><span class="p">(</span><span class="mi">700</span><span class="p">);</span><span class="w"></span>
</span><span id="line-127"><span class="w">        </span><span class="p">}</span><span class="w"></span>
</span><span id="line-128"><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">CapSense_IsWidgetActive</span><span class="p">(</span><span class="n">CapSense_BUTTON5_WDGT_ID</span><span class="p">))</span><span class="w"></span>
</span><span id="line-129"><span class="w">        </span><span class="p">{</span><span class="w"></span>
</span><span id="line-130"><span class="w">         </span><span class="n">which_button</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
</span><span id="line-131"><span class="w">         </span><span class="n">show_info_on_OLED</span><span class="p">(</span><span class="s">"PRIVACY"</span><span class="p">,</span><span class="s">"  MODE "</span><span class="p">);</span><span class="w"></span>
</span><span id="line-132"><span class="w">         </span><span class="n">ButtonLED4_Write</span><span class="p">(</span><span class="o">!</span><span class="n">ButtonLED4_Read</span><span class="p">());</span><span class="w"></span>
</span><span id="line-133"><span class="w">         </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="mi">3</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">++</span><span class="p">)</span><span class="w"></span>
</span><span id="line-134"><span class="w">        </span><span class="p">{</span><span class="w"></span>
</span><span id="line-135"><span class="w">         </span><span class="n">WhiteNoise_PrivacyMode_Write</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"></span>
</span><span id="line-136"><span class="w">         </span><span class="n">CyDelay</span><span class="p">(</span><span class="mi">250</span><span class="p">);</span><span class="w"></span>
</span><span id="line-137"><span class="w">         </span><span class="n">WhiteNoise_PrivacyMode_Write</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
</span><span id="line-138"><span class="w">         </span><span class="n">CyDelay</span><span class="p">(</span><span class="mi">250</span><span class="p">);</span><span class="w"></span>
</span><span id="line-139"><span class="w">         </span><span class="p">}</span><span class="w"> </span>
</span><span id="line-140"><span class="w">        </span><span class="p">}</span><span class="w"></span>
</span><span id="line-141"><span class="w">        </span>
</span><span id="line-142"><span class="w">        </span><span class="c1">// process touch slider to adjust wash speed</span>
</span><span id="line-143"><span class="w">        </span>
</span><span id="line-144"><span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">CapSense_IsWidgetActive</span><span class="p">(</span><span class="n">CapSense_LINEARSLIDER0_WDGT_ID</span><span class="p">))</span><span class="w"></span>
</span><span id="line-145"><span class="w">        </span><span class="p">{</span><span class="w"></span>
</span><span id="line-146"><span class="w">        </span><span class="n">wash_speed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CapSense_GetCentroidPos</span><span class="p">(</span><span class="n">CapSense_LINEARSLIDER0_WDGT_ID</span><span class="p">);</span><span class="w"></span>
</span><span id="line-147"><span class="w">        </span><span class="n">show_info_on_OLED</span><span class="p">(</span><span class="s">"WASHING"</span><span class="p">,</span><span class="s">" SPEED "</span><span class="p">);</span><span class="w"></span>
</span><span id="line-148"><span class="w">        </span><span class="p">}</span><span class="w"></span>
</span><span id="line-149"><span class="w">        </span>
</span><span id="line-150"><span class="w">        </span><span class="c1">// control servo to aim water sprayer nozzle</span>
</span><span id="line-151"><span class="w">        </span>
</span><span id="line-152"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x_pos</span><span class="o">&lt;=</span><span class="mi">100</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">which_button</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
</span><span id="line-153"><span class="w">        </span><span class="p">{</span><span class="w"></span>
</span><span id="line-154"><span class="w">        </span><span class="n">PWM_1_WriteCompare</span><span class="p">(</span><span class="mi">4380</span><span class="o">+</span><span class="p">(</span><span class="n">x_pos</span><span class="p">));</span><span class="w"></span>
</span><span id="line-155"><span class="w">        </span><span class="p">}</span><span class="w"></span>
</span><span id="line-156"><span class="w">        </span>
</span><span id="line-157"><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">y_pos</span><span class="o">&lt;=</span><span class="mi">100</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">which_button</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
</span><span id="line-158"><span class="w">        </span><span class="p">{</span><span class="w"></span>
</span><span id="line-159"><span class="w">        </span><span class="n">PWM_2_WriteCompare</span><span class="p">(</span><span class="mi">4460</span><span class="o">+</span><span class="p">(</span><span class="n">y_pos</span><span class="p">));</span><span class="w"></span>
</span><span id="line-160"><span class="w">        </span><span class="p">}</span><span class="w"></span>
</span><span id="line-161"><span class="w">        </span>
</span><span id="line-162"><span class="w">        </span><span class="c1">//  disable spray water pump's pwm drive </span>
</span><span id="line-163"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">which_button</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
</span><span id="line-164"><span class="w">        </span><span class="p">{</span><span class="w"></span>
</span><span id="line-165"><span class="w">        </span><span class="n">PWM_3_Stop</span><span class="p">();</span><span class="w"></span>
</span><span id="line-166"><span class="w">        </span><span class="p">}</span><span class="w"></span>
</span><span id="line-167"><span class="w">        </span>
</span><span id="line-168"><span class="w">        </span><span class="c1">//  enable spray water pump's pwm drive </span>
</span><span id="line-169"><span class="w">        </span>
</span><span id="line-170"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">which_button</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
</span><span id="line-171"><span class="w">        </span><span class="p">{</span><span class="w"></span>
</span><span id="line-172"><span class="w">        </span><span class="n">PWM_3_Start</span><span class="p">();</span><span class="w"></span>
</span><span id="line-173"><span class="w">        </span>
</span><span id="line-174"><span class="w">        </span><span class="c1">// adjust water flow rate with pwm ducy</span>
</span><span id="line-175"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">wash_speed</span><span class="o">&gt;=</span><span class="mi">10</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">  </span><span class="n">wash_speed</span><span class="o">&lt;=</span><span class="mi">100</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
</span><span id="line-176"><span class="w">            </span><span class="p">{</span><span class="w"></span>
</span><span id="line-177"><span class="w">            </span><span class="n">PWM_3_WriteCompare</span><span class="p">(</span><span class="mi">480</span><span class="o">*</span><span class="p">(</span><span class="n">wash_speed</span><span class="o">/</span><span class="mi">10</span><span class="p">));</span><span class="w">    </span>
</span><span id="line-178"><span class="w">            </span><span class="p">}</span><span class="w"></span>
</span><span id="line-179"><span class="w">        </span><span class="p">}</span><span class="w"></span>
</span><span id="line-180"><span class="w">        </span>
</span><span id="line-181"><span class="w">        </span><span class="c1">// scan all capsense for new user input</span>
</span><span id="line-182"><span class="w">        </span><span class="n">CapSense_ScanAllWidgets</span><span class="p">();</span><span class="w">     </span>
</span><span id="line-183"><span class="w">        </span><span class="c1">//CapSense_UpdateEnabledBaselines();</span>
</span><span id="line-184"><span class="w">         </span>
</span><span id="line-185"><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="c1">// end of forever</span>
</span><span id="line-186"><span class="p">}</span><span class="w"> </span><span class="c1">// end of main</span>
</span></pre>
       </div>
      </div>
     </div>
     <div class="preview-pane" id="code-widget-639743">
      <div class="header">
       <div class="text">
        <div class="title">
         <h3 class="hckui__typography__h3">
          full code
         </h3>
         <span class="hckui__typography__bodyS hckui__typography__pebble">
          C/C++
         </span>
        </div>
        <div class="comment">
         <div class="hckui__typography__bodyS hckui__typography__pebble">
          Unzip and Import to PSoC Creator 4.4 IDE
         </div>
        </div>
       </div>
      </div>
      <div class="preview-body pygments-syntax all">
       <pre>No preview (download only).</pre>
      </div>
     </div>
    </div>
   </div>
  </section>
  <div class="project-section-break">
  </div>
  <div class="project-section-break">
  </div>
 </div>
</div>
