<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/water.css@2/out/water.css"><link rel="stylesheet" href="../custom.css"><div class="middle-column">
 <section id="overview">
  <h1 class="hckui__typography__h1" itemprop="name">
   MovingFan: Enhancing Comfort and Safety
  </h1>
  <p class="hckui__typography__bodyL hckui__layout__marginBottom15" itemprop="description">
   Introducing an idea of a voice-controlled and movement-tracking fan for the visually impaired.
  </p>
  <div class="hckui__layout__marginTop30">
   <div class="hckui__layout__hiddenMedUp">
   </div>
   <div class="project-cover-image" itemprop="image" itemscope="" itemtype="https://schema.org/ImageObject">
    <meta content="https://hackster.imgix.net/uploads/attachments/1750670/media_(1)_Urlq7oRHEJ.gif?auto=format%2Ccompress&amp;gifq=35&amp;w=900&amp;h=675&amp;fit=min&amp;fm=jpg" itemprop="url"/>
    <meta content="900" itemprop="width"/>
    <meta content="675" itemprop="height"/>
    <video autoplay="" data-fallback-src="https://hackster.imgix.net/uploads/attachments/1750670/media_(1)_Urlq7oRHEJ.gif?auto=format%2Ccompress&amp;gifq=35&amp;w=900&amp;h=675&amp;fit=min" id="cover-video" loop="" muted="" playsinline="" poster="https://hackster.imgix.net/uploads/attachments/1750670/media_(1)_Urlq7oRHEJ.gif?auto=format%2Ccompress&amp;gifq=35&amp;w=900&amp;h=675&amp;fit=min&amp;fm=jpg">
     <source src="https://hackster.imgix.net/uploads/attachments/1750670/media_(1)_Urlq7oRHEJ.gif?auto=format%2Ccompress&amp;gifq=35&amp;w=900&amp;h=675&amp;fit=min&amp;fm=mp4" type="video/mp4"/>
     <source src="https://hackster.imgix.net/uploads/attachments/1750670/media_(1)_Urlq7oRHEJ.gif?auto=format%2Ccompress&amp;gifq=35&amp;w=900&amp;h=675&amp;fit=min&amp;fm=webm" type="video/webm"/>
     <script>
      (function() {
  var v = document.getElementById('cover-video');
  if (!v.canPlayType || v.paused) {
    v.innerHTML = '<img src="' + v.getAttribute('data-fallback-src') + '" />';
  }
});
     </script>
    </video>
   </div>
  </div>
 </section>
 <div class="project-section-break">
 </div>
 <div id="project_page_simple_ad_portal">
 </div>
 <div id="description" itemprop="articleBody">
  <section id="things">
   <div class="project-section-title">
    <h2 class="hckui__typography__h2 title-with-anchor">
     <span>
      Things used in this project
     </span>
    </h2>
   </div>
   <div class="project-parts">
    <div class="view-expanded" style="display:block">
     <table class="project-parts-table">
      <colgroup>
       <col style="width: 100px; height: 50px;"/>
       <col style="width: auto;"/>
      </colgroup>
      <tbody>
       <tr class="head">
        <td colspan="2">
         <h3 class="hckui__typography__h3">
          Hardware components
         </h3>
        </td>
        <tr>
         <td class="part-img">
          <img alt="nRF52840 Multi-Protocol SoC" src="10.jpg" srcset="https://hackster.imgix.net/uploads/attachments/1077645/nrf52840-soc_swEUEPLGjk.jpg?auto=compress%2Cformat&amp;w=96&amp;h=96&amp;fit=fill&amp;bg=ffffff 2x, https://hackster.imgix.net/uploads/attachments/1077645/nrf52840-soc_swEUEPLGjk.jpg?auto=compress%2Cformat&amp;w=48&amp;h=48&amp;fit=fill&amp;bg=ffffff"/>
         </td>
         <td class="hckui__typography__bodyL">
          <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"Nordic Semiconductor nRF52840 Multi-Protocol SoC","href":"/nordic-semiconductor/products/nrf52840-multi-protocol-soc?ref=project-f13560","type":"part","location":"things"},"clickOpts":{"delayRedirect":true}}' href="https://www.hackster.io/nordic-semiconductor/products/nrf52840-multi-protocol-soc?ref=project-f13560">
           Nordic Semiconductor nRF52840 Multi-Protocol SoC
          </a>
         </td>
        </tr>
        <tr>
         <td class="part-img">
          <img alt="Blues Starter Kit for Cell+WiFi" src="11.jpg" srcset="https://hackster.imgix.net/uploads/attachments/1636409/global-starterkit-notecardcellwifi-v2_fcndLQSItE.png?auto=compress%2Cformat&amp;w=96&amp;h=96&amp;fit=fill&amp;bg=ffffff 2x, https://hackster.imgix.net/uploads/attachments/1636409/global-starterkit-notecardcellwifi-v2_fcndLQSItE.png?auto=compress%2Cformat&amp;w=48&amp;h=48&amp;fit=fill&amp;bg=ffffff"/>
         </td>
         <td class="hckui__typography__bodyL">
          <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"Blues Starter Kit for Cell+WiFi","href":"/blues-wireless/products/blues-starter-kit-for-cell-wifi?ref=project-f13560","type":"part","location":"things"},"clickOpts":{"delayRedirect":true}}' href="https://www.hackster.io/blues-wireless/products/blues-starter-kit-for-cell-wifi?ref=project-f13560">
           Blues Starter Kit for Cell+WiFi
          </a>
         </td>
        </tr>
        <tr>
         <td class="part-img">
          <img alt="Seeed Studio XIAO ESP32S3 Sense" src="12.jpg" srcset="https://hackster.imgix.net/uploads/attachments/1650360/screenshot_2023-11-20_at_17_16_09_QdLoLAbseq.png?auto=compress%2Cformat&amp;w=96&amp;h=96&amp;fit=fill&amp;bg=ffffff 2x, https://hackster.imgix.net/uploads/attachments/1650360/screenshot_2023-11-20_at_17_16_09_QdLoLAbseq.png?auto=compress%2Cformat&amp;w=48&amp;h=48&amp;fit=fill&amp;bg=ffffff"/>
         </td>
         <td class="hckui__typography__bodyL">
          <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"Seeed Studio XIAO ESP32S3 Sense","href":"/seeed/products/seeed-studio-xiao-esp32s3-sense?ref=project-f13560","type":"part","location":"things"},"clickOpts":{"delayRedirect":true}}' href="https://www.hackster.io/seeed/products/seeed-studio-xiao-esp32s3-sense?ref=project-f13560">
           Seeed Studio XIAO ESP32S3 Sense
          </a>
         </td>
        </tr>
        <tr>
         <td class="part-img">
         </td>
         <td class="hckui__typography__bodyL">
          Seeed Studio Grove Vision AI v2 Kit
         </td>
        </tr>
        <tr>
         <td class="part-img">
          <img alt="DC Motor, 12 V" src="13.jpg" srcset="https://hackster.imgix.net/uploads/attachments/833588/52Y4441-40.jpg?auto=compress%2Cformat&amp;w=96&amp;h=96&amp;fit=fill&amp;bg=ffffff 2x, https://hackster.imgix.net/uploads/attachments/833588/52Y4441-40.jpg?auto=compress%2Cformat&amp;w=48&amp;h=48&amp;fit=fill&amp;bg=ffffff"/>
         </td>
         <td class="hckui__typography__bodyL">
          DC Motor, 12 V
         </td>
        </tr>
        <tr>
         <td class="part-img">
         </td>
         <td class="hckui__typography__bodyL">
          TB6612FNG
         </td>
        </tr>
        <tr>
         <td class="part-img">
          <img alt="SG90 Micro-servo motor" src="14.jpg" srcset="https://hackster.imgix.net/uploads/attachments/657402/SG90-Servo-Motor-180-Degrees-SG90-Micro.jpg?auto=compress%2Cformat&amp;w=96&amp;h=96&amp;fit=fill&amp;bg=ffffff 2x, https://hackster.imgix.net/uploads/attachments/657402/SG90-Servo-Motor-180-Degrees-SG90-Micro.jpg?auto=compress%2Cformat&amp;w=48&amp;h=48&amp;fit=fill&amp;bg=ffffff"/>
         </td>
         <td class="hckui__typography__bodyL">
          SG90 Micro-servo motor
         </td>
        </tr>
       </tr>
       <tr class="head">
        <td colspan="2">
         <h3 class="hckui__typography__h3">
          Software apps and online services
         </h3>
        </td>
       </tr>
       <tr>
        <td class="part-img">
         <img alt="Edge Impulse Studio" src="15.jpg" srcset="https://hackster.imgix.net/uploads/attachments/1125747/picture1_aQHULTyVRc.png?auto=compress%2Cformat&amp;w=96&amp;h=96&amp;fit=fill&amp;bg=ffffff 2x, https://hackster.imgix.net/uploads/attachments/1125747/picture1_aQHULTyVRc.png?auto=compress%2Cformat&amp;w=48&amp;h=48&amp;fit=fill&amp;bg=ffffff"/>
        </td>
        <td class="hckui__typography__bodyL">
         <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"Edge Impulse Studio","href":"/EdgeImpulse/products/edge-impulse-studio?ref=project-f13560","type":"part","location":"things"},"clickOpts":{"delayRedirect":true}}' href="https://www.hackster.io/EdgeImpulse/products/edge-impulse-studio?ref=project-f13560">
          Edge Impulse Studio
         </a>
        </td>
       </tr>
       <tr>
        <td class="part-img">
         <img alt="SenseCraft AI" src="16.jpg" srcset="https://hackster.imgix.net/uploads/attachments/1672847/_CVsbbVapSJ.png?auto=compress%2Cformat&amp;w=96&amp;h=96&amp;fit=fill&amp;bg=ffffff 2x, https://hackster.imgix.net/uploads/attachments/1672847/_CVsbbVapSJ.png?auto=compress%2Cformat&amp;w=48&amp;h=48&amp;fit=fill&amp;bg=ffffff"/>
        </td>
        <td class="hckui__typography__bodyL">
         <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"Seeed Studio SenseCraft AI","href":"/seeed/products/sensecraft-ai?ref=project-f13560","type":"part","location":"things"},"clickOpts":{"delayRedirect":true}}' href="https://www.hackster.io/seeed/products/sensecraft-ai?ref=project-f13560">
          Seeed Studio SenseCraft AI
         </a>
        </td>
       </tr>
       <tr>
        <td class="part-img">
         <img alt="Zephyr RTOS" src="17.jpg" srcset="https://hackster.imgix.net/uploads/attachments/1235235/kite.png?auto=compress%2Cformat&amp;w=96&amp;h=96&amp;fit=fill&amp;bg=ffffff 2x, https://hackster.imgix.net/uploads/attachments/1235235/kite.png?auto=compress%2Cformat&amp;w=48&amp;h=48&amp;fit=fill&amp;bg=ffffff"/>
        </td>
        <td class="hckui__typography__bodyL">
         <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"Zephyr Project Zephyr RTOS","href":"/zephyr-project/products/zephyr-rtos?ref=project-f13560","type":"part","location":"things"},"clickOpts":{"delayRedirect":true}}' href="https://www.hackster.io/zephyr-project/products/zephyr-rtos?ref=project-f13560">
          Zephyr Project Zephyr RTOS
         </a>
        </td>
       </tr>
       <tr>
        <td class="part-img">
         <img alt="Arduino IDE" src="18.jpg" srcset="https://hackster.imgix.net/uploads/image/file/144203/IDE_web.jpg?auto=compress%2Cformat&amp;w=96&amp;h=96&amp;fit=fill&amp;bg=ffffff 2x, https://hackster.imgix.net/uploads/image/file/144203/IDE_web.jpg?auto=compress%2Cformat&amp;w=48&amp;h=48&amp;fit=fill&amp;bg=ffffff"/>
        </td>
        <td class="hckui__typography__bodyL">
         <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"Arduino IDE","href":"/arduino/products/arduino-ide?ref=project-f13560","type":"part","location":"things"},"clickOpts":{"delayRedirect":true}}' href="https://www.hackster.io/arduino/products/arduino-ide?ref=project-f13560">
          Arduino IDE
         </a>
        </td>
       </tr>
      </tbody>
     </table>
    </div>
   </div>
  </section>
  <div class="project-section-break">
  </div>
  <section id="story">
   <div class="project-section-title">
    <h2 class="hckui__typography__h2 title-with-anchor">
     <span>
      Story
     </span>
    </h2>
   </div>
   <div class="project-story collapsible-section collapsed hljs-active hljs-monokai" itemprop="text">
    <p class="hckui__typography__bodyL">
     <em>
      My below work is submitted for Track 2: Adaptation for INDOOR Activities for People with Visual Impairments of Build2gether 2.0
     </em>
    </p>
    <p class="hckui__typography__bodyL">
     This project showcases the development of a prototype automated fan designed to assist visually impaired individuals in staying cool at home during the summer.
    </p>
    <p class="hckui__typography__bodyL">
     The fan operates using a small camera that tracks the user's movement, allowing them to move freely around the room without needing to touch the fan. Additionally, the fan can be controlled through voice recognition, providing a touch-free experience for visually impaired users. The fan is also Wi-Fi enabled, allowing it to be integrated into a smart home ecosystem for efficient power management and remote control.
    </p>
    <h3 class="hckui__typography__h3 title-with-anchor" id="toc-problem-identification-0">
     <p>
      <p class="hckui__typography__bodyL">
      </p>
     </p>
     <span>
      Problem identification
     </span>
    </h3>
    <p class="hckui__typography__bodyL">
     Most fans on the market require users to manually select the desired fan speed and rotation, posing challenges for individuals with disabilities issues. This can lead to discomfort and inconvenience when trying to regulate airflow.
    </p>
    <p class="hckui__typography__bodyL">
     Moreover, for visually impaired individuals, navigating around a fan can be hazardous. Accidental collisions with the fan or malfunctions during operation could lead to injuries from the fan blades or even potential fire hazards.
    </p>
    <h3 class="hckui__typography__h3 title-with-anchor" id="toc-solution-development-1">
     <p>
      <p class="hckui__typography__bodyL">
      </p>
     </p>
     <span>
      Solution development
     </span>
    </h3>
    <p class="hckui__typography__bodyL">
     To address this issue, I developed a smart fan concept that tracks human movement and automatically adjusts the wind direction without requiring any manual intervention.
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="0.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     This prototype incorporates key features of a production model, showcasing the possibility of  functionalities integration into existing fan designs for disabilities.
    </p>
    <p class="hckui__typography__bodyL">
     Key feature of the intelligent fan:
    </p>
    <ul class="hckui__typography__bodyL">
     <li>
      <strong>
       Person Tracking:
      </strong>
      <span>
       The integrated camera tracks movement, alowing the fan's rotation to direct airflow towards the user without the need of manual adjustment.
      </span>
     </li>
     <li>
      <strong>
       Voice Control:
      </strong>
      <span>
       Equipped with a PDM microphone, the fan recognizes voice commands like "on" and "off," making it easier for visually impaired individuals to operate.
      </span>
     </li>
     <li>
      <strong>
       Wi-Fi Connectivity:
      </strong>
      <span>
       The fan connects to the internet, enabling data transmission to the cloud and integration with popular ecosystems such as Datacake and Google Cloud.
      </span>
     </li>
    </ul>
    <h3 class="hckui__typography__h3 title-with-anchor" id="toc-demonstration-2">
     <p>
      <p class="hckui__typography__bodyL">
      </p>
     </p>
     <span>
      Demonstration
     </span>
    </h3>
    <p class="hckui__typography__bodyL">
     This fan should be placed in a room corner to ensure full coverage when users enter. Its Wi-Fi connectivity allows seamless integration into the home's smart ecosystem.
    </p>
    <ul class="hckui__typography__bodyL">
     <li>
      <strong>
       Feature 1
      </strong>
      <span>
       : Person tracking and airflow direction
      </span>
     </li>
    </ul>
    <div class="carousel-images">
     <img class="carousel-image" src="1.jpg"/>
    </div>
    <ul class="hckui__typography__bodyL">
     <li>
      <strong>
       Feature 2
      </strong>
      <span>
       : Voice control. Currently, there are 2 voice commands: on, off
      </span>
     </li>
    </ul>
    <div class="embed-frame">
     <figure class="vimeo">
      <figcaption class="hckui__typography__textCenter hckui__typography__pebble hckui__typography__bodyS hckui__layout__marginTop10">
       OFF command
      </figcaption>
     </figure>
    </div>
    <div class="embed-frame">
     <figure class="vimeo">
      <figcaption class="hckui__typography__textCenter hckui__typography__pebble hckui__typography__bodyS hckui__layout__marginTop10">
       ON command
      </figcaption>
     </figure>
    </div>
    <ul class="hckui__typography__bodyL">
     <li>
      <strong>
       Feature 3:
      </strong>
      <span>
       Cloud connectivity for data transmission and analysis. Sensor data can be pushed to Notehub, then forwarded to popular data platform such as Google Cloud, AWS, etc.
      </span>
     </li>
    </ul>
    <div class="carousel-images">
     <img class="carousel-image" src="2.jpg"/>
    </div>
    <h3 class="hckui__typography__h3 title-with-anchor" id="toc-system-overview-3">
     <p>
      <p class="hckui__typography__bodyL">
      </p>
     </p>
     <span>
      System overview
     </span>
    </h3>
    <p class="hckui__typography__bodyL">
     The below image demonstrates there are 3 main components and how each interact with others.
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="3.jpg"/>
    </div>
    <h3 class="hckui__typography__h3 title-with-anchor" id="toc-1--voice-recognition--amp--safety-4">
     <p>
      <p class="hckui__typography__bodyL">
      </p>
     </p>
     <span>
      1. Voice recognition &amp; Safety
     </span>
    </h3>
    <p class="hckui__typography__bodyL">
     <strong>
      How it works
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     The nRF52840DK uses the PDM microphone for voice input. An ML model, deployed locally on the nRF52840DK using Edge Impulse, processes the voice and outputs the result. The data flow is demonstrated below:
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="4.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     <strong>
      Implementation of the Ultrasonic sensor
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     <span>
      Thanks to the public repository for
     </span>
     <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"the HC-SR04 Zephyr RTOS driver by Daniel Veilleux","href":"https://github.com/inductivekickback/hc-sr04","type":"story","location":"story"},"clickOpts":{"delayRedirect":true}}' href="https://github.com/inductivekickback/hc-sr04" rel="nofollow">
      the HC-SR04 Zephyr RTOS driver by Daniel Veilleux
     </a>
     <span>
      , I was able to reuse the code and accelerate the development of my application.
     </span>
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      Step 1:
     </strong>
     <span>
      Configure the device tree for the HC-SR04 sensor:
     </span>
    </p>
    <pre><code><span>us0: hc-sr04 {</span><br/><span>compatible = "elecfreaks,hc-sr04";</span><br/><span>label = "HC-SR04_0";</span><br/><span>trig-gpios = &lt;&amp;gpio0 26 GPIO_ACTIVE_HIGH&gt;;</span><br/><span>echo-gpios = &lt;&amp;gpio0 27 GPIO_ACTIVE_HIGH&gt;;</span><br/><span>status = "okay";</span><br/><span>};</span></code></pre>
    <p class="hckui__typography__bodyL">
     <strong>
      Step 2:
     </strong>
     <span>
      Move the drivers file to the project directory and add below configuration to the prj.cfg
     </span>
    </p>
    <pre><code><span>CONFIG_SENSOR=y</span><br/><span>CONFIG_GPIO=n</span><br/><span>CONFIG_HC_SR04_NRFX=y</span></code></pre>
    <p class="hckui__typography__bodyL">
     <strong>
      Step 3:
     </strong>
     <span>
      Measure the distance between the object and the fan. If the distance is less than 40 cm, turn off the fan to ensure safety.
     </span>
    </p>
    <pre><code><span></span></code></pre>
    <p class="hckui__typography__bodyL">
     <strong>
      Implementation of the PDM microphone
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     The code on nRF52840DK is built based on the sample wrapper code.
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      Step 1:
     </strong>
     <span>
      Build the voice recognition model using the Edge Impulse platform.
     </span>
    </p>
    <p class="hckui__typography__bodyL">
     Model layer:
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="5.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     Model training result:
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="6.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     <strong>
      Step 2:
     </strong>
     <span>
      Deploy the model as a C++ library
     </span>
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      Step 3:
     </strong>
     <span>
      Configure the PDM microphone as the input for the model on the nRF52840DK.
     </span>
    </p>
    <pre><code><span>&amp;pinctrl {</span><br/><span>	pdm0_default_alt: pdm0_default_alt {</span><br/><span>		group1 {</span><br/><span>			psels = &lt;NRF_PSEL(PDM_CLK, 0, 30)&gt;,</span><br/><span>				&lt;NRF_PSEL(PDM_DIN, 0, 31)&gt;;</span><br/><span>		};</span><br/><span>	};</span><br/><span>};</span><br/><br/><span>dmic_dev: &amp;pdm0 {</span><br/><span>	status = "okay";</span><br/><span>	pinctrl-0 = &lt;&amp;pdm0_default_alt&gt;;</span><br/><span>	pinctrl-names = "default";</span><br/><span>	clock-source = "PCLK32M_HFXO";</span><br/><span>	queue-size = &lt;16000&gt;;</span><br/><span>};</span></code></pre>
    <p class="hckui__typography__bodyL">
     <strong>
      Step 4:
     </strong>
     <span>
      Perform local predictions on the nRF52840DK.
     </span>
    </p>
    <p class="hckui__typography__bodyL">
     Sample debug output of the ML model:
    </p>
    <pre><code><span>* Booting Zephyr OS build v2.6.99-ncs1-14-g15be5e615498  *</span><br/><span>Machine learning model sampling frequency: 52</span><br/><span>Labels assigned by the model:</span><br/><span>- on</span><br/><span>- off</span><br/><span>- noise</span><br/><br/><span>Prediction started...</span><br/><br/><span>Classification results</span><br/><span>======================</span><br/><span>Value: 0.90     Label: on</span><br/><span>Value: 0.10     Label: off</span><br/><span>Value: 0.00     Label: noise</span></code></pre>
    <p class="hckui__typography__bodyL">
     <strong>
      Step 5:
     </strong>
     <span>
      Transmit data via serial output to the STM32 Blackpill
     </span>
    </p>
    <pre><code><span>while (true) {</span><br/><span>    // Get the classification result</span><br/><span>    err = ei_wrapper_get_next_classification_result(&amp;label, &amp;value, NULL);</span><br/><span>    if (err) {</span><br/><span>        if (err == -ENOENT) {</span><br/><span>            err = 0;</span><br/><span>	}</span><br/><span>	break;</span><br/><span>    }</span><br/><span>		</span><br/><span>    // Print out the prediction value</span><br/><span>    printk("Value: %.2f\tLabel: %s\n", value, label);</span><br/><span>    </span><br/><span>    if (label_count == 0) {</span><br/><span>        // Send the highest prediction value through serial</span><br/><span>        int ret = uart_tx(uart, label, sizeof(label), SYS_FOREVER_US);</span><br/><span>        if (ret) {</span><br/><span>            printk("UART sent data failed (err: %d)\n", ret);</span><br/><span>	    return;</span><br/><span>        };</span><br/><span>    label_count++;</span><br/><span>    }</span><br/><span>}</span></code></pre>
    <h3 class="hckui__typography__h3 title-with-anchor" id="toc-2--cloud-integration-5">
     <p>
      <p class="hckui__typography__bodyL">
      </p>
     </p>
     <span>
      2. Cloud integration
     </span>
    </h3>
    <p class="hckui__typography__bodyL">
     <strong>
      How it works
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     The STM32 sends sensor data to the Blues kit via I2C connection. Using the Wi-Fi notecard, the Blues Kit transmits this data to the Notehub at regular intervals—in this case, every 15 seconds. From there, Notehub forwards the data to various popular platforms, including Datacake and Google Cloud.
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="7.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     <strong>
      Implementation
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     Set up a 15-second timer interrupt. On each interrupt, retrieve the sensor data and create a request to send it to Notehub.
    </p>
    <pre><code><span>void timerInterrupt() {</span><br/><span>  /*STM32: Get sensor data */</span><br/><span>  aht.getEvent(&amp;humidity, &amp;temp);</span><br/><span>  /* Notecard: Send to Notehub */</span><br/><span>  J *req = notecard.newRequest("note.add");</span><br/><span>  if (req != NULL)</span><br/><span>  {</span><br/><span>    JAddStringToObject(req, "file", "sensors.qo");</span><br/><span>    JAddBoolToObject(req, "sync", true);</span><br/><span>    J *body = JAddObjectToObject(req, "body");</span><br/><span>    if (body)</span><br/><span>    {</span><br/><span>      JAddNumberToObject(body, "temp", temp.temperature);</span><br/><span>      JAddNumberToObject(body, "humidity", humidity.relative_humidity);      </span><br/><span>    }</span><br/><span>    notecard.sendRequest(req);</span><br/><span>  }</span><br/><span>}</span></code></pre>
    <h3 class="hckui__typography__h3 title-with-anchor" id="toc-3--fan-controller-6">
     <p>
      <p class="hckui__typography__bodyL">
      </p>
     </p>
     <span>
      3. Fan controller
     </span>
    </h3>
    <p class="hckui__typography__bodyL">
     <strong>
      How it works
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     There are two small parts in the fan controller block:
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="8.jpg"/>
    </div>
    <ul class="hckui__typography__bodyL">
     <li>
      STM32: Collects humidity and temperature sensor data for automatically adjusts the DC motor speed. This eliminates the need for users to manually change the fan speed. Additionally, users can turn the fan on or off using voice commands. In the future, I plan to add a feature allowing voice control of fan speed.
     </li>
     <li>
      ESP32 XIAO: Receives the bounding box from the Vision AI Module V2 Kit (deployed using SenseCraftAI) through the SSCMA connection, then rotates the motor to keep the bounding box centered.
     </li>
    </ul>
    <p class="hckui__typography__bodyL">
     <strong>
      Implementation
     </strong>
    </p>
    <ul class="hckui__typography__bodyL">
     <li>
      STM32:
     </li>
    </ul>
    <p class="hckui__typography__bodyL">
     <strong>
      Step 1:
     </strong>
     <span>
      Configure the STM32 for communication with the Blues Kit via I2C. See wring diagrams
     </span>
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      Step 2:
     </strong>
     <span>
      Initialize the connection settings for the Blues Kit to transmit data to Notehub.
     </span>
    </p>
    <pre><code><span>/* Notecard */</span><br/><span>notecard.begin();</span><br/><span>notecard.setDebugOutputStream(usbSerial);</span><br/><span>/* Notecard: Connect to Notehub */</span><br/><span>J *req = notecard.newRequest("hub.set");</span><br/><span>JAddStringToObject(req, "product", productUID);</span><br/><span>JAddStringToObject(req, "mode", "continuous");</span><br/><span>notecard.sendRequest(req);</span></code></pre>
    <p class="hckui__typography__bodyL">
     <strong>
      Step 3:
     </strong>
     <span>
      Forward data from Notehub to other platforms.
     </span>
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      Step 4:
     </strong>
     <span>
      Initialize the sensor and collect environmental data, then calculate the fan speed accordingly.
     </span>
    </p>
    <pre><code><span>int adjustFanSpeed(float temp, float humid) {</span><br/><span>  /* Adjust fan speed based on the temp &amp; humid from AHT10 */</span><br/><span>  int speed = 0;</span><br/><span>  if (temp &gt; 40) {</span><br/><span>    speed = 150;</span><br/><span>  } else if ((temp &lt;= 40) &amp;&amp; (temp &gt;= 30)) {</span><br/><span>    speed = 100;</span><br/><span>  } else {</span><br/><span>    speed = 50;</span><br/><span>  }</span><br/><span>  if (humid &gt; 80) {</span><br/><span>    speed = speed - 10;</span><br/><span>  } else if ((humid &lt;= 80) &amp;&amp; (humid &gt;= 50)) {</span><br/><span>    speed = speed;</span><br/><span>  } else {</span><br/><span>    speed = speed + 10;</span><br/><span>  }</span><br/><span>  return speed;</span><br/><span>}</span></code></pre>
    <p class="hckui__typography__bodyL">
     <strong>
      Step 5:
     </strong>
     <span>
      Receive voice commands via serial from the nRF52840 DK to control the fan operation mode (on or off).
     </span>
    </p>
    <pre><code><span>void adjustFanModes() {</span><br/><span>  /*Adjust fan modes based on the UART receive from nRF52840 */</span><br/><span>  while (Serial.available() &gt;= 0) {</span><br/><span>    int receivedData = Serial.read();</span><br/><span>    if (receivedData == 1) {</span><br/><span>      digitalWrite(PIN_STBY, HIGH);</span><br/><span>    } else if (receivedData == 0) {</span><br/><span>      // Turn off the motor</span><br/><span>      digitalWrite(PIN_STBY, LOW);</span><br/><span>    }</span><br/><span>  }</span><br/><span>}</span></code></pre>
    <ul class="hckui__typography__bodyL">
     <li>
      ESP32:
     </li>
    </ul>
    <p class="hckui__typography__bodyL">
     <strong>
      Step 1:
     </strong>
     <span>
      Deployed the Face Detection AI model on SenseCraftAI on the Vision AI Module V2 Kit as below.
     </span>
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="9.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     <strong>
      Step 2:
     </strong>
     <span>
      Retrieve the bounding box data from the Vision AI Module V2 Kit and adjust the servo motors to center the bounding box on the screen.
     </span>
    </p>
    <pre><code><span>// Rotate the camera to make sure the bounding box is centered</span><br/><span>if (!model.invoke()) {</span><br/><span>    Serial.println("Invoke success");</span><br/><span>    // If the bounding boxes are valid</span><br/><span>    if (model.boxes().size() &gt; 0) {</span><br/><span>	    // Get current axis</span><br/><span>      int x = model.boxes()[0].x;</span><br/><span>      int y = model.boxes()[0].y;</span><br/><span>      // Move to camera</span><br/><span>      int new_x = encode_x(x);</span><br/><span>      horizontal_move(new_x);  </span><br/><span>      int new_y = encode_y(x);</span><br/><span>      vertical_move(new_y);</span><br/><span>      }</span><br/><span>}</span></code></pre>
    <h3 class="hckui__typography__h3 title-with-anchor" id="toc-further-improvements-7">
     <p>
      <p class="hckui__typography__bodyL">
      </p>
     </p>
     <span>
      Further improvements
     </span>
    </h3>
    <ul class="hckui__typography__bodyL">
     <li>
      Implement voice control for adjusting fan speed.
     </li>
     <li>
      Develop a smartphone application for remote control.
     </li>
     <li>
      Design a custom PCB to integrate all components.
     </li>
    </ul>
    <h3 class="hckui__typography__h3 title-with-anchor" id="toc-credit-8">
     <p>
      <p class="hckui__typography__bodyL">
      </p>
     </p>
     <span>
      Credit
     </span>
    </h3>
    <ul class="hckui__typography__bodyL">
     <li>
      Thank you to the contest organizers for providing valuable insights and feedback. I also extend my gratitude to the competition sponsors, including Arm, Blues, DFRobot, M5Stack, Nordic Semiconductor, PCBWay, Seeed Studio and Hackster. A special thanks to the many friends who answered my questions on Discord.
     </li>
     <li>
      I would like to express my appreciation the public repository for the HC-SR04 Zephyr RTOS driver by Daniel Veilleux, which allowed me to use the code and speed up the development of my application.
     </li>
    </ul>
   </div>
  </section>
  <div class="project-section-break">
  </div>
  <section id="schematics">
   <div class="project-section-title">
    <h2 class="hckui__typography__h2 title-with-anchor">
     <span>
      Schematics
     </span>
    </h2>
   </div>
   <div class="project-attachment">
    <div class="header">
     <div class="text">
      <h3 class="hckui__typography__h3">
       Cloud integration component
      </h3>
     </div>
    </div>
    <div class="embed original boxed hckui__typography__textCenter">
     <img src="19.jpg"/>
    </div>
   </div>
   <div class="project-attachment">
    <div class="header">
     <div class="text">
      <h3 class="hckui__typography__h3">
       Voice recognition &amp; Safety component
      </h3>
     </div>
    </div>
    <div class="embed original boxed hckui__typography__textCenter">
     <img src="20.jpg"/>
    </div>
   </div>
   <div class="project-attachment">
    <div class="header">
     <div class="text">
      <h3 class="hckui__typography__h3">
       Fan controller component
      </h3>
     </div>
    </div>
    <div class="embed original boxed hckui__typography__textCenter">
     <img src="21.jpg"/>
    </div>
   </div>
  </section>
  <div class="project-section-break">
  </div>
  <section id="code">
   <div class="project-section-title">
    <h2 class="hckui__typography__h2 title-with-anchor">
     <span>
      Code
     </span>
    </h2>
   </div>
   <div class="project-attachment">
    <div class="header">
     <div class="text">
      <h3 class="hckui__typography__h3">
       Github
      </h3>
     </div>
    </div>
    <a href="https://github.com/mikidiclo/hackster-build2gether">
     Github
    </a>
   </div>
  </section>
  <div class="project-section-break">
  </div>
  <div class="project-section-break">
  </div>
 </div>
</div>
