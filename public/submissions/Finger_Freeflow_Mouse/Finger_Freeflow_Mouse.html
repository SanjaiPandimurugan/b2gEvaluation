<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/water.css@2/out/water.css"><link rel="stylesheet" href="../custom.css"><div class="middle-column">
 <section id="overview">
  <h1 class="hckui__typography__h1" itemprop="name">
   Finger Freeflow Mouse
  </h1>
  <p class="hckui__typography__bodyL hckui__layout__marginBottom15" itemprop="description">
   A tethered mouse with smart touch recognition for comfortable, drift-free, and intuitive control.
  </p>
  <div class="hckui__layout__marginTop30">
   <div class="hckui__layout__hiddenMedUp">
   </div>
   <div class="project-cover-image" itemprop="image" itemscope="" itemtype="https://schema.org/ImageObject">
    <meta content="https://hackster.imgix.net/uploads/attachments/1756768/_MQetz4YzIF.blob?auto=compress&amp;w=900&amp;h=675&amp;fit=min&amp;fm=jpg" itemprop="url"/>
    <meta content="900" itemprop="width"/>
    <meta content="675" itemprop="height"/>
    <img alt="Finger Freeflow Mouse" src="25.jpg"/>
   </div>
  </div>
 </section>
 <div class="project-section-break">
 </div>
 <div id="project_page_simple_ad_portal">
 </div>
 <div id="description" itemprop="articleBody">
  <section id="things">
   <div class="project-section-title">
    <h2 class="hckui__typography__h2 title-with-anchor">
     <span>
      Things used in this project
     </span>
    </h2>
   </div>
   <div class="project-parts">
    <div class="view-expanded" style="display:block">
     <table class="project-parts-table">
      <colgroup>
       <col style="width: 100px; height: 50px;"/>
       <col style="width: auto;"/>
      </colgroup>
      <tbody>
       <tr class="head">
        <td colspan="2">
         <h3 class="hckui__typography__h3">
          Hardware components
         </h3>
        </td>
        <tr>
         <td class="part-img">
         </td>
         <td class="hckui__typography__bodyL">
          PMW3360DM optical mouse sensor
         </td>
        </tr>
        <tr>
         <td class="part-img">
         </td>
         <td class="hckui__typography__bodyL">
          Eye Screws
         </td>
        </tr>
        <tr>
         <td class="part-img">
         </td>
         <td class="hckui__typography__bodyL">
          Large Masonite Board
         </td>
        </tr>
        <tr>
         <td class="part-img">
          <img alt="Seeed Studio XIAO ESP32S3 Sense" src="26.jpg" srcset="https://hackster.imgix.net/uploads/attachments/1650360/screenshot_2023-11-20_at_17_16_09_QdLoLAbseq.png?auto=compress%2Cformat&amp;w=96&amp;h=96&amp;fit=fill&amp;bg=ffffff 2x, https://hackster.imgix.net/uploads/attachments/1650360/screenshot_2023-11-20_at_17_16_09_QdLoLAbseq.png?auto=compress%2Cformat&amp;w=48&amp;h=48&amp;fit=fill&amp;bg=ffffff"/>
         </td>
         <td class="hckui__typography__bodyL">
          <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"Seeed Studio XIAO ESP32S3 Sense","href":"/seeed/products/seeed-studio-xiao-esp32s3-sense?ref=project-f71a30","type":"part","location":"things"},"clickOpts":{"delayRedirect":true}}' href="https://www.hackster.io/seeed/products/seeed-studio-xiao-esp32s3-sense?ref=project-f71a30">
           Seeed Studio XIAO ESP32S3 Sense
          </a>
         </td>
        </tr>
        <tr>
         <td class="part-img">
         </td>
         <td class="hckui__typography__bodyL">
          Mouse Buddy PCB
         </td>
        </tr>
        <tr>
         <td class="part-img">
         </td>
         <td class="hckui__typography__bodyL">
          Freeflow Mouse PCB
         </td>
        </tr>
       </tr>
      </tbody>
     </table>
    </div>
   </div>
  </section>
  <div class="project-section-break">
  </div>
  <section id="story">
   <div class="project-section-title">
    <h2 class="hckui__typography__h2 title-with-anchor">
     <span>
      Story
     </span>
    </h2>
   </div>
   <div class="project-story collapsible-section collapsed hljs-active hljs-monokai" itemprop="text">
    <h3 class="hckui__typography__h3 title-with-anchor" id="toc---finger-freeflow-mouse-0">
     <p>
      <p class="hckui__typography__bodyL">
      </p>
     </p>
     <span>
      üíª Finger Freeflow Mouse
     </span>
    </h3>
    <p class="hckui__typography__bodyL">
     This project is the "Finger Freeflow Mouse" which is a device inspired by conversations with Vivek from the original Build2Gether competition. Back then I failed to deliver on that vision as my PCB design skills were still in infancy so I ended up with a very different end project. When I heard Build2Gether was back in a 2.0 form I opted to tackle this idea in earnest as there was a mobility section for the contest and I really wanted to build a useful device that could aid people in this way.
    </p>
    <div class="embed-frame">
     <figure class="youtube">
      <iframe allowfullscreen="" frameborder="0" height="500" src="//www.youtube.com/embed/v-qmu2cEOPk?rel=0" style="margin: 10px auto; display: block;" width="75%">
      </iframe>
     </figure>
    </div>
    <div class="carousel-images">
     <img class="carousel-image" src="0.jpg"/>
    </div>
    <h3 class="hckui__typography__h3 title-with-anchor" id="toc---background-1">
     <p>
      <p class="hckui__typography__bodyL">
      </p>
     </p>
     <span>
      ‚è≤ Background
     </span>
    </h3>
    <p class="hckui__typography__bodyL">
     Mice give an unparalleled level of control when PC gaming. You can try to replace it with joysticks but it just isn't the same:
    </p>
    <p class="hckui__typography__bodyL">
     To emulate a mouse with a joystick you need to move the mouse in the direction the controller stick is moved and, most likely, increase or decrease the speed based on how heavily tilted the stick is in that direction. This makes moving the mouse harder as you need to completely pull the stick back in the opposite direction if you over shoot your intended goal. It also makes for very hard precision control relative to a mouse.
    </p>
    <h3 class="hckui__typography__h3 title-with-anchor" id="toc---idea-2">
     <p>
      <p class="hckui__typography__bodyL">
      </p>
     </p>
     <span>
      üí° Idea
     </span>
    </h3>
    <p class="hckui__typography__bodyL">
     My idea was to create a mouse that opens up possibilities for gaming by reducing the need for the user to physically move it around while still providing all of the same button and high precision control a traditional mouse provides.
    </p>
    <p class="hckui__typography__bodyL">
     <strong>
      The general idea is a bit like this:
     </strong>
    </p>
    <p class="hckui__typography__bodyL">
     The mouse sits on a baseboard centered for use by someone comfortably with limited mobility. The baseboard contains several screw eyes aligning to each side of the mouse allowing for 2.5mm elastic cords to be passed through from the mouse and tightened. The mouse as such is able to hover over the board. Kind of creating the experience of a one person "Ouija board" that defaults back to its normal position but has some resistance from every angle to allow for it to be moved in that direction. It's as accurate as a normal mouse when a user wants to control it (and positioned such that buttons are in a more optimal location) but also still stationary for limited mobility use
    </p>
    <p class="hckui__typography__bodyL">
     Additional buttons on the mouse will provide input means for the user. They need to be very sensitive to toch such that they can trigger immediately on user activation.
    </p>
    <h3 class="hckui__typography__h3 title-with-anchor" id="toc------thank-you-project-sponsors-3">
     <p>
      <p class="hckui__typography__bodyL">
      </p>
     </p>
     <span>
      ü¶∏‚Äç‚ôÄÔ∏è Thank You Project Sponsors!
     </span>
    </h3>
    <p class="hckui__typography__bodyL">
     <span>
      I'd like to thank
     </span>
     <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"JLCPCB ","href":"https://jlcpcb.com/","type":"story","location":"story"},"clickOpts":{"delayRedirect":true}}' href="https://jlcpcb.com/" rel="nofollow">
      JLCPCB
     </a>
     <span>
      /
     </span>
     <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"JLC3DP ","href":"https://jlc3dp.com/","type":"story","location":"story"},"clickOpts":{"delayRedirect":true}}' href="https://jlc3dp.com/" rel="nofollow">
      JLC3DP
     </a>
     <span>
      for sponsoring the Freeflow Mouse PCB board I used for the project and providing a resin printed piece that I used for the mouse cover. The resin really makes for a nice surface to touch the mouse and it really brings things to life -- I was surprised with how well it came out given it was my first time with a resin print. The team over at JLC3DP was great in that they confirmed about support usage to get it printing perfectly so I didn't have to worry about the intricacies of resin printing. The PCB looks great and has worked great for my needs. The whole process on the JLCPCB and JLC3DP site was straightforward and the product arrived quickly. The connection to EasyEDA made use of the site simple as well as one can export directly to JLCPCB for ordering after creation.
     </span>
    </p>
    <p class="hckui__typography__bodyL">
     <span>
      I'd also like to thank the sponsor
     </span>
     <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"PCBWay ","href":"https://www.pcbway.com/","type":"story","location":"story"},"clickOpts":{"delayRedirect":true}}' href="https://www.pcbway.com/" rel="nofollow">
      PCBWay
     </a>
     <span>
      for providing the contest coupon for use with their services. I utilized their services for the Mouse Buddy PCB I designed. It worked great and fit perfectly with my main board PCB. I plan on using the Mouse Buddy for all sorts of projects in the future and it really turned out so well. Their website can be referenced for information about their services but I will say every time I've used them I've been impressed with their quality and speed at which the board arrives.
     </span>
    </p>
    <p class="hckui__typography__bodyL">
     <span>
      In addition to the PCB manufacturers I utilized the Xiao ESP32S3 from the sponsor
     </span>
     <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"Seeed Studio","href":"https://www.seeedstudio.com/","type":"story","location":"story"},"clickOpts":{"delayRedirect":true}}' href="https://www.seeedstudio.com/" rel="nofollow">
      Seeed Studio
     </a>
     <span>
      . I've used the Xiao boards extensively in the past and knew it would make for a great microcontroller for this project as it is small, has no components on the bottom, and price effective.
     </span>
    </p>
    <h3 class="hckui__typography__h3 title-with-anchor" id="toc---pcbs-4">
     <p>
      <p class="hckui__typography__bodyL">
      </p>
     </p>
     <span>
      üí´ PCBs
     </span>
    </h3>
    <p class="hckui__typography__bodyL">
     <strong>
      Mouse
     </strong>
     <span>
     </span>
     <strong>
      Buddy
     </strong>
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="1.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     The Mouse Buddy PCB utilizes a PMW3360 for movement. It acts as a core board for various mouse related projects. It needs 1V9 voltage for powering the device so a voltage regulator was needed. Aside from that it expects only 3V3 and anything more will likely damage the sensor. The components and layout were structured to allow the board to be reused for various projects by either plugging in via the headers or using a cable to connect.
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="2.jpg"/>
    </div>
    <div class="carousel-images">
     <img class="carousel-image" src="3.jpg"/>
     <img class="carousel-image" src="4.jpg"/>
     <img class="carousel-image" src="5.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     <br/>
    </p>
    <div class="embed-frame">
     <figure class="youtube">
      <iframe allowfullscreen="" frameborder="0" height="500" src="//www.youtube.com/embed/59wCci7UDoE?rel=0" style="margin: 10px auto; display: block;" width="75%">
      </iframe>
     </figure>
    </div>
    <p class="hckui__typography__bodyL">
     <strong>
      Freeflow
     </strong>
     <span>
     </span>
     <strong>
      Mouse
     </strong>
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="6.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     The Freeflow Mouse PCB has a few elements that help it work together with the core board to act as a full mouse. Primarily it exposes headers for connecting to the Mouse Core providing it the 3V3 power and additional connections for each of its associated pins. To add to the polish of the experience some sk2812 mini LEDs were also added along with a level shifter to provide 5V for the signal. A MPR121 was utilized to provide touch control for the buttons.
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="7.jpg"/>
    </div>
    <div class="carousel-images">
     <img class="carousel-image" src="8.jpg"/>
     <img class="carousel-image" src="9.jpg"/>
     <img class="carousel-image" src="10.jpg"/>
    </div>
    <h3 class="hckui__typography__h3 title-with-anchor" id="toc---code-5">
     <p>
      <p class="hckui__typography__bodyL">
      </p>
     </p>
     <span>
      üéâ Code
     </span>
    </h3>
    <p class="hckui__typography__bodyL">
     The code for the project is attached. It's fairly straightforward and really is the combination of neopixel lighting, MPR121 touch button control, and the PMW3360 for movement. It utilized USB-OTG for allowing the device as a USB mouse.
    </p>
    <p class="hckui__typography__bodyL">
     <span>
      First it's imperative to setup the Xiao as you would normally for Arduino.
     </span>
     <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"Seeeds wiki","href":"https://wiki.seeedstudio.com/xiao_esp32s3_getting_started/#software-preparation","type":"story","location":"story"},"clickOpts":{"delayRedirect":true}}' href="https://wiki.seeedstudio.com/xiao_esp32s3_getting_started/#software-preparation" rel="nofollow">
      Seeed's wiki
     </a>
     <span>
      has more information on this process but the short of it is you add the
     </span>
     <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"board definition file for the espressif boards","href":"https://raw.githubusercontent.com/espressif/arduino-esp32/gh-pages/package_esp32_index.json","type":"story","location":"story"},"clickOpts":{"delayRedirect":true}}' href="https://raw.githubusercontent.com/espressif/arduino-esp32/gh-pages/package_esp32_index.json" rel="nofollow">
      board definition file for the espressif boards
     </a>
     <span>
      to your board definition list in settings and it allows the ESP32 based boards to be added to your list.
     </span>
    </p>
    <p class="hckui__typography__bodyL">
     Once that's done you'll need the following libraries as well:
    </p>
    <ul class="hckui__typography__bodyL">
     <li>
      <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"Adafruit MPR121","href":"https://github.com/adafruit/Adafruit_MPR121","type":"story","location":"story"},"clickOpts":{"delayRedirect":true}}' href="https://github.com/adafruit/Adafruit_MPR121" rel="nofollow">
       Adafruit MPR121
      </a>
     </li>
     <li>
      <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"PMW3360","href":"https://github.com/SunjunKim/PMW3360","type":"story","location":"story"},"clickOpts":{"delayRedirect":true}}' href="https://github.com/SunjunKim/PMW3360" rel="nofollow">
       PMW3360
      </a>
     </li>
     <li>
      <a class="hckui__typography__linkBlue" data-ha='{"eventName":"Clicked link","customProps":{"value":"Adafruit Neopixel","href":"https://github.com/adafruit/Adafruit_NeoPixel","type":"story","location":"story"},"clickOpts":{"delayRedirect":true}}' href="https://github.com/adafruit/Adafruit_NeoPixel" rel="nofollow">
       Adafruit Neopixel
      </a>
     </li>
    </ul>
    <p class="hckui__typography__bodyL">
     With those in place using the attached code you should be able to build and deploy the mouse.
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="11.jpg"/>
    </div>
    <h3 class="hckui__typography__h3 title-with-anchor" id="toc---hardware--setup-6">
     <p>
      <p class="hckui__typography__bodyL">
      </p>
     </p>
     <span>
      üí™ Hardware  Setup
     </span>
    </h3>
    <p class="hckui__typography__bodyL">
     Print the three STL files. They are assembled by snapping the boards onto the 3D prints. I used heatset inserts to allow m3 screws to hold the cover tightly to the base when it's sandwiched in. To install these I used my soldering iron and pushed them into the holes along the base.
    </p>
    <p class="hckui__typography__bodyL">
     For passing the connectivity I utilized conductive paint painting the buttons but this wasn't enough so I had to use double sided copper tape to further allow the connection to work. You can see it in my images below but placing some below the finger spots attached to the conductive paint and above the buttons on the PCB worked well for this purpose.
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="12.jpg"/>
     <img class="carousel-image" src="13.jpg"/>
     <img class="carousel-image" src="14.jpg"/>
     <img class="carousel-image" src="15.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     After the parts are assembled the mouse should be attached to a baseboard to allow it to move around. I used eye screws around the exterior to fix the four points around the print to the outer board. In this way it hovers above the board ever so slightly.
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="16.jpg"/>
     <img class="carousel-image" src="17.jpg"/>
     <img class="carousel-image" src="18.jpg"/>
    </div>
    <h3>
    </h3>
    <div class="carousel-images">
     <img class="carousel-image" src="19.jpg"/>
    </div>
    <h3 class="hckui__typography__h3 title-with-anchor" id="toc---mouse-utilization-7">
     <p>
      <p class="hckui__typography__bodyL">
      </p>
     </p>
     <span>
      üéâ Mouse Utilization
     </span>
    </h3>
    <p class="hckui__typography__bodyL">
     The mouse has various buttons including:
    </p>
    <ul class="hckui__typography__bodyL">
     <li>
      Increase and decrease sensitivity (indicated via the onboard LED color as to the level)
     </li>
     <li>
      Back and forward mouse buttons which move you through browser history (usually on the side of gaming mice)
     </li>
     <li>
      Left click
     </li>
     <li>
      Right click
     </li>
     <li>
      Middle mouse button
     </li>
     <li>
      LED toggle for the underlying LED effects
     </li>
     <li>
      Thumb button for toggling movement
     </li>
    </ul>
    <p class="hckui__typography__bodyL">
     The mouse can be used by pressing down on the thumb button and then pushing the device. This will move the cursor until you remove your thumb from the button. Releasing this allows you to spring back to the default position and further push the mouse from there. The benefit to this approach is that by having the mouse reset each time one does not need to pick up the mouse to readjust it but can rely on it going back.
    </p>
    <h3 class="hckui__typography__h3 title-with-anchor" id="toc---challenges-8">
     <p>
      <p class="hckui__typography__bodyL">
      </p>
     </p>
     <span>
      üòÖ Challenges
     </span>
    </h3>
    <p class="hckui__typography__bodyL">
     I had originally planned on using magnets to further hold the board up but that didn't work out well given the polarity acted odd when the magnet was turned to its side. I opted instead to rely on a lighter board and utilizing the strings more heavily.
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="20.jpg"/>
     <img class="carousel-image" src="21.jpg"/>
     <img class="carousel-image" src="22.jpg"/>
     <img class="carousel-image" src="23.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     <br/>
    </p>
    <p class="hckui__typography__bodyL">
     The buttons also struggled to respond without heavy amounts of copper tape. In future iterations it would likely make sense to rely less on conductive paint as it wasn't as effective at transmitting the signal as I had hoped. It took a lot of additional tape to get the mouse to where it is today working so I think it's definitely an area it could be further improved.
    </p>
    <div class="carousel-images">
     <img class="carousel-image" src="24.jpg"/>
    </div>
    <p class="hckui__typography__bodyL">
     <br/>
    </p>
    <p class="hckui__typography__bodyL">
     The elastic bands have worked well but I feel like it's one of the elements of the project that could be replaced in a future iteration for a more effective rebound mechanism. Additional experimentation into better forms of resistance (large rubber bands perhaps) could be useful for future iterations.
    </p>
    <p class="hckui__typography__bodyL">
     One mistake I made earlier on was to use a Xiao ESP32C3. It worked well for my demo code trying out the MPR121 and PMW3360 components but it doesn't support USB-OTG so I had to desolder the microcontroller and replace it to get the final product working.
    </p>
    <p class="hckui__typography__bodyL">
     This was my first project utilizing a QFN-20 footprint component. I struggled heavily getting it in place but ended up succeeding in the end. I found using my heat gun on the footprint with the solder paste initially, dragging the component over the hot solder, and then positioning it perfectly over the solder points worked well. I think in retrospect I'd surface additional test points on the PCB if I were to use a QFN-20 part again to confirm I don't bridge any connections but things luckily worked out here.
    </p>
    <h3>
    </h3>
   </div>
  </section>
  <div class="project-section-break">
  </div>
  <section id="cad">
   <div class="project-section-title">
    <h2 class="hckui__typography__h2 title-with-anchor">
     <span>
      Custom parts and enclosures
     </span>
    </h2>
   </div>
   <div class="project-attachment">
    <div class="header">
     <div class="text">
      <h3 class="hckui__typography__h3">
       Mouse Body.stl
      </h3>
     </div>
    </div>
    <p>
     Sketchfab still processing.
    </p>
   </div>
   <div class="project-attachment">
    <div class="header">
     <div class="text">
      <h3 class="hckui__typography__h3">
       Mouse Touch.stl
      </h3>
     </div>
    </div>
    <p>
     Sketchfab still processing.
    </p>
   </div>
   <div class="project-attachment">
    <div class="header">
     <div class="text">
      <h3 class="hckui__typography__h3">
       Mouse Cover.stl
      </h3>
     </div>
    </div>
    <p>
     Sketchfab still processing.
    </p>
   </div>
  </section>
  <div class="project-section-break">
  </div>
  <section id="schematics">
   <div class="project-section-title">
    <h2 class="hckui__typography__h2 title-with-anchor">
     <span>
      Schematics
     </span>
    </h2>
   </div>
   <div class="project-attachment">
    <div class="header">
     <div class="text">
      <h3 class="hckui__typography__h3">
       Freeflow Mouse Schematic
      </h3>
     </div>
    </div>
    <div class="embed four-by-three">
     <iframe frameborder="0" height="100%" src="https://docs.google.com/gview?url=https://hacksterio.s3.amazonaws.com/uploads/attachments/1756435/schematic_freeflow-mouse_2024-09-05_lXybDSLZuv.pdf&amp;embedded=true" width="100%">
     </iframe>
    </div>
   </div>
   <div class="project-attachment">
    <div class="header">
     <div class="text">
      <h3 class="hckui__typography__h3">
       Freeflow Mouse Control Board Schematic
      </h3>
     </div>
    </div>
    <div class="embed four-by-three">
     <iframe frameborder="0" height="100%" src="https://docs.google.com/gview?url=https://hacksterio.s3.amazonaws.com/uploads/attachments/1756436/schematic_freeflow-mouse-touch-control-board_2024-09-05_PqT2NdHWTT.pdf&amp;embedded=true" width="100%">
     </iframe>
    </div>
   </div>
  </section>
  <div class="project-section-break">
  </div>
  <section id="code">
   <div class="project-section-title">
    <h2 class="hckui__typography__h2 title-with-anchor">
     <span>
      Code
     </span>
    </h2>
   </div>
   <div class="project-attachment project-code-widget single-file">
    <div class="tabs hckui__typography__bodyS">
     <ul>
      <li class="active">
       <a data-target="#code-widget-657550" href="javascript:void(0)">
        FreeflowMouse.ino
       </a>
      </li>
     </ul>
    </div>
    <div class="preview-container">
     <div class="preview-pane active" id="code-widget-657550">
      <div class="header">
       <div class="text">
        <div class="title">
         <h3 class="hckui__typography__h3">
          FreeflowMouse.ino
         </h3>
         <span class="hckui__typography__bodyS hckui__typography__pebble">
          Arduino
         </span>
        </div>
        <div class="comment">
         <div class="hckui__typography__bodyS hckui__typography__pebble">
          Arduino Code for the Freeflow Mouse
         </div>
        </div>
       </div>
      </div>
      <div class="preview-body pygments-syntax arduino">
       <div class="highlight">
        <pre><span></span><span id="line-1"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;Wire.h&gt;</span><span class="cp"></span>
</span><span id="line-2"><span class="cp">#include</span><span class="w"> </span><span class="cpf">"Adafruit_MPR121.h"</span><span class="cp"></span>
</span><span id="line-3"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;PMW3360.h&gt;</span><span class="cp"></span>
</span><span id="line-4"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;Adafruit_NeoPixel.h&gt;</span><span class="cp"></span>
</span><span id="line-5"><span class="cp">#include</span><span class="w"> </span><span class="cpf">"USB.h"</span><span class="cp"></span>
</span><span id="line-6"><span class="cp">#include</span><span class="w"> </span><span class="cpf">"USBHIDMouse.h"</span><span class="cp"></span>
</span><span id="line-7">
</span><span id="line-8"><span class="cp">#define SS A0</span>
</span><span id="line-9"><span class="cp">#define NEOPIXEL_PIN A3</span>
</span><span id="line-10"><span class="cp">#define NUMPIXELS 5</span>
</span><span id="line-11">
</span><span id="line-12"><span class="c1">// Initialize sensors and LEDs</span>
</span><span id="line-13"><span class="n">Adafruit_MPR121</span><span class="w"> </span><span class="n">cap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Adafruit_MPR121</span><span class="p">();</span><span class="w"></span>
</span><span id="line-14"><span class="n">PMW3360</span><span class="w"> </span><span class="n">sensor</span><span class="p">;</span><span class="w"></span>
</span><span id="line-15"><span class="n">Adafruit_NeoPixel</span><span class="w"> </span><span class="n">strip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Adafruit_NeoPixel</span><span class="p">(</span><span class="n">NUMPIXELS</span><span class="p">,</span><span class="w"> </span><span class="n">NEOPIXEL_PIN</span><span class="p">,</span><span class="w"> </span><span class="n">NEO_GRB</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">NEO_KHZ800</span><span class="p">);</span><span class="w"></span>
</span><span id="line-16"><span class="n">USBHIDMouse</span><span class="w"> </span><span class="nf">Mouse</span><span class="p">;</span><span class="w"></span>
</span><span id="line-17">
</span><span id="line-18"><span class="kr">uint16_t</span><span class="w"> </span><span class="n">lasttouched</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
</span><span id="line-19"><span class="kr">uint16_t</span><span class="w"> </span><span class="n">currtouched</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
</span><span id="line-20">
</span><span id="line-21"><span class="kr">bool</span><span class="w"> </span><span class="n">mouseEnabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">false</span><span class="p">;</span><span class="w"></span>
</span><span id="line-22"><span class="kr">bool</span><span class="w"> </span><span class="n">neopixelsEnabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">false</span><span class="p">;</span><span class="w"></span>
</span><span id="line-23"><span class="kr">int</span><span class="w"> </span><span class="n">mouseSpeed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">  </span><span class="c1">// 0 to 4, corresponds to different speed levels</span>
</span><span id="line-24"><span class="kr">unsigned</span><span class="w"> </span><span class="kr">long</span><span class="w"> </span><span class="n">lastPressTime</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">};</span><span class="w"></span>
</span><span id="line-25"><span class="kr">unsigned</span><span class="w"> </span><span class="kr">long</span><span class="w"> </span><span class="n">lastRainbowTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
</span><span id="line-26"><span class="kr">int</span><span class="w"> </span><span class="n">rainbowWait</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"></span>
</span><span id="line-27"><span class="kr">long</span><span class="w"> </span><span class="n">firstPixelHue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
</span><span id="line-28">
</span><span id="line-29"><span class="kr">void</span><span class="w"> </span><span class="nf">setMovementLevelColor</span><span class="p">(</span><span class="kr">int</span><span class="w"> </span><span class="n">level</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
</span><span id="line-30"><span class="w">  </span><span class="kr">uint32_t</span><span class="w"> </span><span class="n">color</span><span class="p">;</span><span class="w"></span>
</span><span id="line-31"><span class="w">  </span><span class="kr">uint8_t</span><span class="w"> </span><span class="n">brightness</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">50</span><span class="p">;</span><span class="w">  </span><span class="c1">// Adjust brightness to be less intense</span>
</span><span id="line-32"><span class="w">  </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">level</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
</span><span id="line-33"><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strip</span><span class="p">.</span><span class="n">Color</span><span class="p">(</span><span class="n">brightness</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="k">break</span><span class="p">;</span><span class="w"> </span><span class="c1">// Red</span>
</span><span id="line-34"><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strip</span><span class="p">.</span><span class="n">Color</span><span class="p">(</span><span class="n">brightness</span><span class="p">,</span><span class="w"> </span><span class="n">brightness</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="k">break</span><span class="p">;</span><span class="w"> </span><span class="c1">// Yellow</span>
</span><span id="line-35"><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strip</span><span class="p">.</span><span class="n">Color</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">brightness</span><span class="p">);</span><span class="w"> </span><span class="k">break</span><span class="p">;</span><span class="w"> </span><span class="c1">// Blue</span>
</span><span id="line-36"><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">3</span><span class="o">:</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strip</span><span class="p">.</span><span class="n">Color</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">brightness</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="k">break</span><span class="p">;</span><span class="w"> </span><span class="c1">// Green</span>
</span><span id="line-37"><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">4</span><span class="o">:</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strip</span><span class="p">.</span><span class="n">Color</span><span class="p">(</span><span class="n">brightness</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">brightness</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="k">break</span><span class="p">;</span><span class="w"> </span><span class="c1">// Purple</span>
</span><span id="line-38"><span class="w">  </span><span class="p">}</span><span class="w"></span>
</span><span id="line-39"><span class="w">  </span><span class="n">strip</span><span class="p">.</span><span class="n">setPixelColor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="p">);</span><span class="w"></span>
</span><span id="line-40"><span class="w">  </span><span class="n">strip</span><span class="p">.</span><span class="n">show</span><span class="p">();</span><span class="w"></span>
</span><span id="line-41"><span class="p">}</span><span class="w"></span>
</span><span id="line-42">
</span><span id="line-43"><span class="kr">void</span><span class="w"> </span><span class="nf">clearStrip</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
</span><span id="line-44"><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kr">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">strip</span><span class="p">.</span><span class="n">numPixels</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
</span><span id="line-45"><span class="w">    </span><span class="n">strip</span><span class="p">.</span><span class="n">setPixelColor</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"></span>
</span><span id="line-46"><span class="w">  </span><span class="p">}</span><span class="w"></span>
</span><span id="line-47"><span class="w">  </span><span class="n">strip</span><span class="p">.</span><span class="n">show</span><span class="p">();</span><span class="w"></span>
</span><span id="line-48"><span class="p">}</span><span class="w"></span>
</span><span id="line-49">
</span><span id="line-50"><span class="kr">void</span><span class="w"> </span><span class="nf">nonBlockingRainbow</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
</span><span id="line-51"><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nf">millis</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">lastRainbowTime</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">rainbowWait</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
</span><span id="line-52"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kr">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">strip</span><span class="p">.</span><span class="n">numPixels</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
</span><span id="line-53"><span class="w">      </span><span class="kr">int</span><span class="w"> </span><span class="n">pixelHue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">firstPixelHue</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">65536L</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">strip</span><span class="p">.</span><span class="n">numPixels</span><span class="p">());</span><span class="w"></span>
</span><span id="line-54"><span class="w">      </span><span class="n">strip</span><span class="p">.</span><span class="n">setPixelColor</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">strip</span><span class="p">.</span><span class="n">gamma32</span><span class="p">(</span><span class="n">strip</span><span class="p">.</span><span class="n">ColorHSV</span><span class="p">(</span><span class="n">pixelHue</span><span class="p">)));</span><span class="w"></span>
</span><span id="line-55"><span class="w">    </span><span class="p">}</span><span class="w"></span>
</span><span id="line-56"><span class="w">    </span><span class="n">strip</span><span class="p">.</span><span class="n">show</span><span class="p">();</span><span class="w"></span>
</span><span id="line-57"><span class="w">    </span><span class="n">firstPixelHue</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">256</span><span class="p">;</span><span class="w">  </span><span class="c1">// Update the hue for the next frame</span>
</span><span id="line-58"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">firstPixelHue</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">65536</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
</span><span id="line-59"><span class="w">      </span><span class="n">firstPixelHue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
</span><span id="line-60"><span class="w">    </span><span class="p">}</span><span class="w"></span>
</span><span id="line-61"><span class="w">    </span><span class="n">lastRainbowTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">millis</span><span class="p">();</span><span class="w">  </span><span class="c1">// Update the time</span>
</span><span id="line-62"><span class="w">  </span><span class="p">}</span><span class="w"></span>
</span><span id="line-63"><span class="p">}</span><span class="w"></span>
</span><span id="line-64">
</span><span id="line-65"><span class="kr">void</span><span class="w"> </span><span class="nb">setup</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
</span><span id="line-66"><span class="w">  </span><span class="c1">// Setup Touch Sensor</span>
</span><span id="line-67"><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">cap</span><span class="p">.</span><span class="nf">begin</span><span class="p">(</span><span class="mh">0x5A</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="nf">Wire</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
</span><span id="line-68"><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
</span><span id="line-69"><span class="w">  </span><span class="p">}</span><span class="w"></span>
</span><span id="line-70">
</span><span id="line-71"><span class="w">  </span><span class="c1">// Setup Mouse Sensor</span>
</span><span id="line-72"><span class="w">  </span><span class="n">sensor</span><span class="p">.</span><span class="nf">begin</span><span class="p">(</span><span class="n">SS</span><span class="p">);</span><span class="w"></span>
</span><span id="line-73"><span class="w">  </span>
</span><span id="line-74"><span class="w">  </span><span class="c1">// Setup Neopixels</span>
</span><span id="line-75"><span class="w">  </span><span class="n">strip</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span><span class="w"></span>
</span><span id="line-76"><span class="w">  </span><span class="n">strip</span><span class="p">.</span><span class="n">show</span><span class="p">();</span><span class="w">  </span><span class="c1">// Initialize all pixels to 'off'</span>
</span><span id="line-77">
</span><span id="line-78"><span class="w">  </span><span class="c1">// Initialize LED for mouse scroll speed indicator</span>
</span><span id="line-79"><span class="w">  </span><span class="n">setMovementLevelColor</span><span class="p">(</span><span class="n">mouseSpeed</span><span class="p">);</span><span class="w"></span>
</span><span id="line-80">
</span><span id="line-81"><span class="w">  </span><span class="c1">// Setup USB HID Mouse</span>
</span><span id="line-82"><span class="w">  </span><span class="nf">Mouse</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span><span class="w"></span>
</span><span id="line-83"><span class="w">  </span><span class="n">USB</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span><span class="w"></span>
</span><span id="line-84"><span class="p">}</span><span class="w"></span>
</span><span id="line-85">
</span><span id="line-86"><span class="kr">void</span><span class="w"> </span><span class="nb">loop</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
</span><span id="line-87"><span class="w">  </span><span class="c1">// Poll the touch sensor for button presses</span>
</span><span id="line-88"><span class="w">  </span><span class="n">currtouched</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cap</span><span class="p">.</span><span class="n">touched</span><span class="p">();</span><span class="w"></span>
</span><span id="line-89">
</span><span id="line-90"><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kr">uint8_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">9</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
</span><span id="line-91"><span class="w">    </span><span class="kr">unsigned</span><span class="w"> </span><span class="kr">long</span><span class="w"> </span><span class="n">currentMillis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">millis</span><span class="p">();</span><span class="w"></span>
</span><span id="line-92">
</span><span id="line-93"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">currtouched</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">_BV</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="p">(</span><span class="n">lasttouched</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">_BV</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">currentMillis</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">lastPressTime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">500</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
</span><span id="line-94"><span class="w">      </span><span class="n">lastPressTime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">currentMillis</span><span class="p">;</span><span class="w"></span>
</span><span id="line-95">
</span><span id="line-96"><span class="w">      </span><span class="c1">// Handle touch press actions</span>
</span><span id="line-97"><span class="w">      </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
</span><span id="line-98"><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w">  </span><span class="c1">// Increase speed</span>
</span><span id="line-99"><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mouseSpeed</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="n">mouseSpeed</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
</span><span id="line-100"><span class="w">          </span><span class="n">setMovementLevelColor</span><span class="p">(</span><span class="n">mouseSpeed</span><span class="p">);</span><span class="w"></span>
</span><span id="line-101"><span class="w">          </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
</span><span id="line-102"><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w">  </span><span class="c1">// Mouse Forward</span>
</span><span id="line-103"><span class="w">          </span><span class="nf">Mouse</span><span class="p">.</span><span class="nf">press</span><span class="p">(</span><span class="n">MOUSE_FORWARD</span><span class="p">);</span><span class="w"></span>
</span><span id="line-104"><span class="w">          </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
</span><span id="line-105"><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w">  </span><span class="c1">// Enable mouse control (hold down to enable)</span>
</span><span id="line-106"><span class="w">          </span><span class="n">mouseEnabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">true</span><span class="p">;</span><span class="w"></span>
</span><span id="line-107"><span class="w">          </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
</span><span id="line-108"><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="mi">3</span><span class="o">:</span><span class="w">  </span><span class="c1">// Middle button</span>
</span><span id="line-109"><span class="w">          </span><span class="nf">Mouse</span><span class="p">.</span><span class="nf">press</span><span class="p">(</span><span class="n">MOUSE_MIDDLE</span><span class="p">);</span><span class="w"></span>
</span><span id="line-110"><span class="w">          </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
</span><span id="line-111"><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="mi">4</span><span class="o">:</span><span class="w">  </span><span class="c1">// Left click</span>
</span><span id="line-112"><span class="w">          </span><span class="nf">Mouse</span><span class="p">.</span><span class="nf">press</span><span class="p">(</span><span class="n">MOUSE_LEFT</span><span class="p">);</span><span class="w"></span>
</span><span id="line-113"><span class="w">          </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
</span><span id="line-114"><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="mi">5</span><span class="o">:</span><span class="w">  </span><span class="c1">// Right click</span>
</span><span id="line-115"><span class="w">          </span><span class="nf">Mouse</span><span class="p">.</span><span class="nf">press</span><span class="p">(</span><span class="n">MOUSE_RIGHT</span><span class="p">);</span><span class="w"></span>
</span><span id="line-116"><span class="w">          </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
</span><span id="line-117"><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="mi">6</span><span class="o">:</span><span class="w">  </span><span class="c1">// Toggle Neopixels</span>
</span><span id="line-118"><span class="w">          </span><span class="n">neopixelsEnabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">neopixelsEnabled</span><span class="p">;</span><span class="w"></span>
</span><span id="line-119"><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">neopixelsEnabled</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
</span><span id="line-120"><span class="w">            </span><span class="n">clearStrip</span><span class="p">();</span><span class="w"> </span>
</span><span id="line-121"><span class="w">          </span><span class="p">}</span><span class="w"></span>
</span><span id="line-122"><span class="w">          </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
</span><span id="line-123"><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="mi">7</span><span class="o">:</span><span class="w">  </span><span class="c1">// Mouse Backward</span>
</span><span id="line-124"><span class="w">          </span><span class="nf">Mouse</span><span class="p">.</span><span class="nf">press</span><span class="p">(</span><span class="n">MOUSE_BACKWARD</span><span class="p">);</span><span class="w"></span>
</span><span id="line-125"><span class="w">          </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
</span><span id="line-126"><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="mi">8</span><span class="o">:</span><span class="w">  </span><span class="c1">// Decrease speed</span>
</span><span id="line-127"><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mouseSpeed</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">mouseSpeed</span><span class="o">--</span><span class="p">;</span><span class="w"></span>
</span><span id="line-128"><span class="w">          </span><span class="n">setMovementLevelColor</span><span class="p">(</span><span class="n">mouseSpeed</span><span class="p">);</span><span class="w"></span>
</span><span id="line-129"><span class="w">          </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
</span><span id="line-130"><span class="w">      </span><span class="p">}</span><span class="w"></span>
</span><span id="line-131"><span class="w">    </span><span class="p">}</span><span class="w"></span>
</span><span id="line-132">
</span><span id="line-133"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">currtouched</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">_BV</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">lasttouched</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">_BV</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
</span><span id="line-134"><span class="w">      </span><span class="c1">// Handle touch release actions</span>
</span><span id="line-135"><span class="w">      </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
</span><span id="line-136"><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w">  </span><span class="c1">// Mouse Forward release</span>
</span><span id="line-137"><span class="w">          </span><span class="nf">Mouse</span><span class="p">.</span><span class="nf">release</span><span class="p">(</span><span class="n">MOUSE_FORWARD</span><span class="p">);</span><span class="w"></span>
</span><span id="line-138"><span class="w">          </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
</span><span id="line-139"><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w">  </span><span class="c1">// Disable mouse control</span>
</span><span id="line-140"><span class="w">          </span><span class="n">mouseEnabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">false</span><span class="p">;</span><span class="w"></span>
</span><span id="line-141"><span class="w">          </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
</span><span id="line-142"><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="mi">3</span><span class="o">:</span><span class="w">  </span><span class="c1">// Middle button release</span>
</span><span id="line-143"><span class="w">          </span><span class="nf">Mouse</span><span class="p">.</span><span class="nf">release</span><span class="p">(</span><span class="n">MOUSE_MIDDLE</span><span class="p">);</span><span class="w"></span>
</span><span id="line-144"><span class="w">          </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
</span><span id="line-145"><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="mi">4</span><span class="o">:</span><span class="w">  </span><span class="c1">// Left click release</span>
</span><span id="line-146"><span class="w">          </span><span class="nf">Mouse</span><span class="p">.</span><span class="nf">release</span><span class="p">(</span><span class="n">MOUSE_LEFT</span><span class="p">);</span><span class="w"></span>
</span><span id="line-147"><span class="w">          </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
</span><span id="line-148"><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="mi">5</span><span class="o">:</span><span class="w">  </span><span class="c1">// Right click release</span>
</span><span id="line-149"><span class="w">          </span><span class="nf">Mouse</span><span class="p">.</span><span class="nf">release</span><span class="p">(</span><span class="n">MOUSE_RIGHT</span><span class="p">);</span><span class="w"></span>
</span><span id="line-150"><span class="w">          </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
</span><span id="line-151"><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="mi">7</span><span class="o">:</span><span class="w">  </span><span class="c1">// Mouse Backward release</span>
</span><span id="line-152"><span class="w">          </span><span class="nf">Mouse</span><span class="p">.</span><span class="nf">release</span><span class="p">(</span><span class="n">MOUSE_BACKWARD</span><span class="p">);</span><span class="w"></span>
</span><span id="line-153"><span class="w">          </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
</span><span id="line-154"><span class="w">      </span><span class="p">}</span><span class="w"></span>
</span><span id="line-155"><span class="w">    </span><span class="p">}</span><span class="w"></span>
</span><span id="line-156"><span class="w">  </span><span class="p">}</span><span class="w"></span>
</span><span id="line-157">
</span><span id="line-158"><span class="w">  </span><span class="n">lasttouched</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">currtouched</span><span class="p">;</span><span class="w"></span>
</span><span id="line-159">
</span><span id="line-160"><span class="w">  </span><span class="c1">// Poll the sensor for movement data</span>
</span><span id="line-161"><span class="w">  </span><span class="n">PMW3360_DATA</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sensor</span><span class="p">.</span><span class="n">readBurst</span><span class="p">();</span><span class="w"></span>
</span><span id="line-162"><span class="w">  </span>
</span><span id="line-163"><span class="w">  </span><span class="c1">// Handle mouse movement if enabled</span>
</span><span id="line-164"><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mouseEnabled</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">data</span><span class="p">.</span><span class="n">isOnSurface</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">data</span><span class="p">.</span><span class="n">isMotion</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
</span><span id="line-165"><span class="w">    </span><span class="nf">Mouse</span><span class="p">.</span><span class="nf">move</span><span class="p">(</span><span class="o">-</span><span class="n">data</span><span class="p">.</span><span class="n">dx</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">mouseSpeed</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="o">-</span><span class="n">data</span><span class="p">.</span><span class="n">dy</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">mouseSpeed</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"></span>
</span><span id="line-166"><span class="w">  </span><span class="p">}</span><span class="w"></span>
</span><span id="line-167">
</span><span id="line-168"><span class="w">  </span><span class="c1">// Run Neopixel rainbow animation if enabled</span>
</span><span id="line-169"><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">neopixelsEnabled</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
</span><span id="line-170"><span class="w">    </span><span class="n">nonBlockingRainbow</span><span class="p">();</span><span class="w"></span>
</span><span id="line-171"><span class="w">  </span><span class="p">}</span><span class="w"></span>
</span><span id="line-172">
</span><span id="line-173"><span class="w">  </span><span class="nf">delay</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span><span class="w"></span>
</span><span id="line-174"><span class="p">}</span><span class="w"></span>
</span></pre>
       </div>
      </div>
     </div>
    </div>
   </div>
  </section>
  <div class="project-section-break">
  </div>
  <div class="project-section-break">
  </div>
 </div>
</div>
